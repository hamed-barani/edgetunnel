/*!
  * v2ray Subscription Worker v2.4
  * Copyright 2024 Vahid Farid (https://twitter.com/vahidfarid)
  * Licensed under GPLv3 (https://github.com/vfarid/v2ray-worker/blob/main/Licence.md)
  */ var x,i,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__require=(x=function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):x),__esm=(e,t)=>function n(){return e&&(t=(0,e[__getOwnPropNames(e)[0]])(e=0)),t},__commonJS=(e,t)=>function n(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__copyProps=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames(t))__hasOwnProp.call(e,o)||o===n||__defProp(e,o,{get:()=>t[o],enumerable:!(r=__getOwnPropDesc(t,o))||r.enumerable});return e},__toESM=(e,t,n)=>(n=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?n:__defProp(n,"default",{value:e,enumerable:!0}),e)),init_wrangler_modules_watch=__esm({"wrangler-modules-watch:wrangler:modules-watch"(){init_modules_watch_stub()}}),init_modules_watch_stub=__esm({"node_modules/wrangler/templates/modules-watch-stub.js"(){init_wrangler_modules_watch()}}),require_crypto=__commonJS({"(disabled):crypto"(){init_modules_watch_stub()}}),require_core=__commonJS({"node_modules/crypto-js/core.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(){var e=e||function(e,t){if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&"undefined"!=typeof global&&global.crypto&&(r=global.crypto),!r&&"function"==typeof __require)try{r=require_crypto()}catch(n){}var r,o=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},u=a.lib={},$=u.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=u.WordArray=$.extend({init:function(e,t){e=this.words=e||[],void 0!=t?this.sigBytes=t:this.sigBytes=4*e.length},toString:function(e){return(e||_).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var s=0;s<o;s++){var a=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=a<<24-(r+s)%4*8}else for(var u=0;u<o;u+=4)t[r+u>>>2]=n[u>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=$.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(o());return new l.init(t,e)}}),c=a.enc={},_=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new l.init(n,t/2)}},p=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var s=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new l.init(n,t)}},d=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},h=u.BufferedBlockAlgorithm=$.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,s=r.sigBytes,a=this.blockSize,u=s/(4*a),$=(u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*a,c=e.min(4*$,s);if($){for(var _=0;_<$;_+=a)this._doProcessBlock(o,_);n=o.splice(0,$),r.sigBytes-=c}return new l.init(n,c)},clone:function(){var e=$.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});u.Hasher=h.extend({cfg:$.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}});var g=a.algo={};return a}(Math);return e},"object"==typeof e?t.exports=e=r():"function"==typeof define&&define.amd?define([],r):n.CryptoJS=r()}}),require_sha256=__commonJS({"node_modules/crypto-js/sha256.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){var t,n,r,o,s,a,u,$,l,c;return t=Math,o=(r=(n=e).lib).WordArray,s=r.Hasher,a=n.algo,u=[],$=[],function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return(e-(0|e))*4294967296|0}for(var r=2,o=0;o<64;)e(r)&&(o<8&&(u[o]=n(t.pow(r,.5))),$[o]=n(t.pow(r,1/3)),o++),r++}(),l=[],c=a.SHA256=s.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],s=n[2],a=n[3],u=n[4],c=n[5],_=n[6],p=n[7],d=0;d<64;d++){if(d<16)l[d]=0|e[t+d];else{var h=l[d-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,m=l[d-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[d]=g+l[d-7]+y+l[d-16]}var b=u&c^~u&_,C=r&o^r&s^o&s,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),v=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+b+$[d]+l[d],E=w+C;p=_,_=c,c=u,u=a+v|0,a=s,s=o,o=r,r=v+E|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+_|0,n[7]=n[7]+p|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;return n[o>>>5]|=128<<24-o%32,n[(o+64>>>9<<4)+14]=t.floor(r/4294967296),n[(o+64>>>9<<4)+15]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA256=s._createHelper(c),n.HmacSHA256=s._createHmacHelper(c),e.SHA256},"object"==typeof e?t.exports=e=r(require_core()):"function"==typeof define&&define.amd?define(["./core"],r):r(n.CryptoJS)}}),require_sha224=__commonJS({"node_modules/crypto-js/sha224.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){var t,n,r,o,s;return n=(t=e).lib.WordArray,o=(r=t.algo).SHA256,s=r.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=o._createHelper(s),t.HmacSHA224=o._createHmacHelper(s),e.SHA224},"object"==typeof e?t.exports=e=r(require_core(),require_sha256()):"function"==typeof define&&define.amd?define(["./core","./sha256"],r):r(n.CryptoJS)}}),require_enc_hex=__commonJS({"node_modules/crypto-js/enc-hex.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){return e.enc.Hex},"object"==typeof e?t.exports=e=r(require_core()):"function"==typeof define&&define.amd?define(["./core"],r):r(n.CryptoJS)}}),require_bcrypt=__commonJS({"node_modules/bcryptjs/dist/bcrypt.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(){"use strict";var e={},n=null;function r(e){if(void 0!==t&&t&&t.exports)try{return __require("crypto").randomBytes(e)}catch(r){}try{var o;return(self.crypto||self.msCrypto).getRandomValues(o=new Uint32Array(e)),Array.prototype.slice.call(o)}catch(s){}if(!n)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return n(e)}var o=!1;try{r(1),o=!0}catch(s){}function a(e,t){for(var n=0,r=0,o=0,s=e.length;o<s;++o)e.charCodeAt(o)===t.charCodeAt(o)?++n:++r;return!(n<0)&&0===r}n=null,e.setRandomFallback=function(e){n=e},e.genSaltSync=function(e,t){if("number"!=typeof(e=e||m))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var n=[];return n.push("$2a$"),e<10&&n.push("0"),n.push(e.toString()),n.push("$"),n.push(_(r(g),g)),n.join("")},e.genSalt=function(t,n,r){if("function"==typeof n&&(r=n,n=void 0),"function"==typeof t&&(r=t,t=void 0),void 0===t)t=m;else if("number"!=typeof t)throw Error("illegal arguments: "+typeof t);function o(n){u(function(){try{n(null,e.genSaltSync(t))}catch(r){n(r)}})}if(!r)return new Promise(function(e,t){o(function(n,r){if(n){t(n);return}e(r)})});if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);o(r)},e.hashSync=function(t,n){if(void 0===n&&(n=m),"number"==typeof n&&(n=e.genSaltSync(n)),"string"!=typeof t||"string"!=typeof n)throw Error("Illegal arguments: "+typeof t+", "+typeof n);return k(t,n)},e.hash=function(t,n,r,o){function s(r){"string"==typeof t&&"number"==typeof n?e.genSalt(n,function(e,n){k(t,n,r,o)}):"string"==typeof t&&"string"==typeof n?k(t,n,r,o):u(r.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof n)))}if(!r)return new Promise(function(e,t){s(function(n,r){if(n){t(n);return}e(r)})});if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);s(r)},e.compareSync=function(t,n){if("string"!=typeof t||"string"!=typeof n)throw Error("Illegal arguments: "+typeof t+", "+typeof n);return 60===n.length&&a(e.hashSync(t,n.substr(0,n.length-31)),n)},e.compare=function(t,n,r,o){function s(r){if("string"!=typeof t||"string"!=typeof n){u(r.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof n)));return}if(60!==n.length){u(r.bind(this,null,!1));return}e.hash(t,n.substr(0,29),function(e,t){e?r(e):r(null,a(t,n))},o)}if(!r)return new Promise(function(e,t){s(function(n,r){if(n){t(n);return}e(r)})});if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);s(r)},e.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},e.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var u="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout,$="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),l=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],c=String.fromCharCode;function _(e,t){var n,r,o=0,s=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;o<t;){if(n=255&e[o++],s.push($[n>>2&63]),n=(3&n)<<4,o>=t||(n|=(r=255&e[o++])>>4&15,s.push($[63&n]),n=(15&r)<<2,o>=t)){s.push($[63&n]);break}n|=(r=255&e[o++])>>6&3,s.push($[63&n]),s.push($[63&r])}return s.join("")}function p(e,t){var n,r,o,s,a,u,$=0,_=e.length,p=0,d=[];if(t<=0)throw Error("Illegal len: "+t);for(;$<_-1&&p<t&&(n=(u=e.charCodeAt($++))<l.length?l[u]:-1,r=(u=e.charCodeAt($++))<l.length?l[u]:-1,-1!=n&&-1!=r)&&(a=n<<2>>>0,a|=(48&r)>>4,d.push(c(a)),!(++p>=t||$>=_||-1==(o=(u=e.charCodeAt($++))<l.length?l[u]:-1)||(a=(15&r)<<4>>>0,a|=(60&o)>>2,d.push(c(a)),++p>=t||$>=_)));){s=(u=e.charCodeAt($++))<l.length?l[u]:-1,a=(3&o)<<6>>>0,a|=s,d.push(c(a)),++p}var h=[];for($=0;$<p;$++)h.push(d[$].charCodeAt(0));return h}var d,h=((d={}).MAX_CODEPOINT=1114111,d.encodeUTF8=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(n>>6&31|192),t(63&n|128)):n<65536?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},d.decodeUTF8=function(e,t){for(var n,r,o,s,a=function(e){var t=Error((e=e.slice(0,e.indexOf(null))).toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if((128&n)==0)t(n);else if((224&n)==192)null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if((240&n)==224)(null===(r=e())||null===(o=e()))&&a([n,r,o]),t((15&n)<<12|(63&r)<<6|63&o);else if((248&n)==240)(null===(r=e())||null===(o=e())||null===(s=e()))&&a([n,r,o,s]),t((7&n)<<18|(63&r)<<12|(63&o)<<6|63&s);else throw RangeError("Illegal starting byte: "+n)},d.UTF16toUTF8=function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());){if(n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343){t((n-55296)*1024+r-56320+65536),r=null;continue}t(n)}null!==r&&t(r)},d.UTF8toUTF16=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(((n-=65536)>>10)+55296),t(n%1024+56320)),n=null},d.encodeUTF16toUTF8=function(e,t){d.UTF16toUTF8(e,function(e){d.encodeUTF8(e,t)})},d.decodeUTF8toUTF16=function(e,t){d.decodeUTF8(e,function(e){d.UTF8toUTF16(e,t)})},d.calculateCodePoint=function(e){return e<128?1:e<2048?2:e<65536?3:4},d.calculateUTF8=function(e){for(var t,n=0;null!==(t=e());)n+=d.calculateCodePoint(t);return n},d.calculateUTF16asUTF8=function(e){var t=0,n=0;return d.UTF16toUTF8(e,function(e){++t,n+=d.calculateCodePoint(e)}),[t,n]},d);Date.now=Date.now||function(){return+new Date};var g=16,m=10,y=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],b=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],C=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function w(e,t,n,r){var o,s=e[t],a=e[t+1];return s^=n[0],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[1],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[2],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[3],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[4],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[5],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[6],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[7],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[8],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[9],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[10],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[11],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[12],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[13],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[14],o=r[s>>>24],o+=r[256|s>>16&255],o^=r[512|s>>8&255],o+=r[768|255&s],a^=o^n[15],o=r[a>>>24],o+=r[256|a>>16&255],o^=r[512|a>>8&255],o+=r[768|255&a],s^=o^n[16],e[t]=a^n[17],e[t+1]=s,e}function v(e,t){for(var n=0,r=0;n<4;++n)r=r<<8|255&e[t],t=(t+1)%e.length;return{key:r,offp:t}}function E(e,t,n){for(var r,o=0,s=[0,0],a=t.length,u=n.length,$=0;$<a;$++)o=(r=v(e,o)).offp,t[$]=t[$]^r.key;for($=0;$<a;$+=2)s=w(s,0,t,n),t[$]=s[0],t[$+1]=s[1];for($=0;$<u;$+=2)s=w(s,0,t,n),n[$]=s[0],n[$+1]=s[1]}function A(e,t,n,r,o){var s,a,$=C.slice(),l=$.length;if(n<4||n>31){if(a=Error("Illegal number of rounds (4-31): "+n),r){u(r.bind(this,a));return}throw a}if(t.length!==g){if(a=Error("Illegal salt length: "+t.length+" != "+g),r){u(r.bind(this,a));return}throw a}n=1<<n>>>0;var c,_,p,d=0;function h(){if(o&&o(d/n),d<n)for(var s=Date.now();d<n&&(d+=1,E(e,c,_),E(t,c,_),!(Date.now()-s>100)););else{for(d=0;d<64;d++)for(p=0;p<l>>1;p++)w($,p<<1,c,_);var a=[];for(d=0;d<l;d++)a.push(($[d]>>24&255)>>>0),a.push(($[d]>>16&255)>>>0),a.push(($[d]>>8&255)>>>0),a.push((255&$[d])>>>0);return r?(r(null,a),void 0):a}r&&u(h)}if(Int32Array?(c=new Int32Array(y),_=new Int32Array(b)):(c=y.slice(),_=b.slice()),function e(t,n,r,o){for(var s,a=0,u=[0,0],$=r.length,l=o.length,c=0;c<$;c++)a=(s=v(n,a)).offp,r[c]=r[c]^s.key;for(c=0,a=0;c<$;c+=2)a=(s=v(t,a)).offp,u[0]^=s.key,a=(s=v(t,a)).offp,u[1]^=s.key,u=w(u,0,r,o),r[c]=u[0],r[c+1]=u[1];for(c=0;c<l;c+=2)a=(s=v(t,a)).offp,u[0]^=s.key,a=(s=v(t,a)).offp,u[1]^=s.key,u=w(u,0,r,o),o[c]=u[0],o[c+1]=u[1]}(t,e,c,_),void 0!==r)h();else for(;;)if(void 0!==(s=h()))return s||[]}function k(e,t,n,r){if("string"!=typeof e||"string"!=typeof t){if(o=Error("Invalid string / salt: Not a string"),n){u(n.bind(this,o));return}throw o}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(o=Error("Invalid salt version: "+t.substring(0,2)),n){u(n.bind(this,o));return}throw o}if("$"===t.charAt(2))s="\0",a=3;else{if("a"!==(s=t.charAt(2))&&"b"!==s&&"y"!==s||"$"!==t.charAt(3)){if(o=Error("Invalid salt revision: "+t.substring(2,4)),n){u(n.bind(this,o));return}throw o}a=4}if(t.charAt(a+2)>"$"){if(o=Error("Missing salt rounds"),n){u(n.bind(this,o));return}throw o}var o,s,a,$,l,c,d=10*parseInt(t.substring(a,a+1),10),m=parseInt(t.substring(a+1,a+2),10),y=d+m,b=t.substring(a+3,a+25);e+=s>="a"?"\0":"";var w=($=e,l=[],c=0,h.encodeUTF16toUTF8(function(){return c>=$.length?null:$.charCodeAt(c++)},function(e){l.push(e)}),l),v=p(b,g);function E(e){var t=[];return t.push("$2"),s>="a"&&t.push(s),t.push("$"),y<10&&t.push("0"),t.push(y.toString()),t.push("$"),t.push(_(v,v.length)),t.push(_(e,4*C.length-1)),t.join("")}if(void 0===n)return E(A(w,v,y));A(w,v,y,function(e,t){e?n(e,null):n(null,E(t))},r)}return e.encodeBase64=_,e.decodeBase64=p,e},"function"==typeof define&&define.amd?define([],r):"function"==typeof __require&&"object"==typeof t&&t&&t.exports?t.exports=r():(n.dcodeIO=n.dcodeIO||{}).bcrypt=r()}}),require_base64_js=__commonJS({"node_modules/base64-js/index.js"(e){"use strict";init_modules_watch_stub(),e.byteLength=function e(t){var n=u(t),r=n[0],o=n[1];return(r+o)*3/4-o},e.toByteArray=function e(t){var n,r,a,$,l,c=u(t),_=c[0],p=c[1],d=new s(($=_,l=p,($+l)*3/4-l)),h=0,g=p>0?_-4:_;for(r=0;r<g;r+=4)n=o[t.charCodeAt(r)]<<18|o[t.charCodeAt(r+1)]<<12|o[t.charCodeAt(r+2)]<<6|o[t.charCodeAt(r+3)],d[h++]=n>>16&255,d[h++]=n>>8&255,d[h++]=255&n;return 2===p&&(n=o[t.charCodeAt(r)]<<2|o[t.charCodeAt(r+1)]>>4,d[h++]=255&n),1===p&&(n=o[t.charCodeAt(r)]<<10|o[t.charCodeAt(r+1)]<<4|o[t.charCodeAt(r+2)]>>2,d[h++]=n>>8&255,d[h++]=255&n),d},e.fromByteArray=function e(t){for(var n,o=t.length,s=o%3,a=[],u=0,$=o-s;u<$;u+=16383)a.push(l(t,u,u+16383>$?$:u+16383));return 1===s?a.push(r[(n=t[o-1])>>2]+r[n<<4&63]+"=="):2===s&&a.push(r[(n=(t[o-2]<<8)+t[o-1])>>10]+r[n>>4&63]+r[n<<2&63]+"="),a.join("")};var t,n,r=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,n=a.length;t<n;++t)r[t]=a[t],o[a.charCodeAt(t)]=t;function u(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function $(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function l(e,t,n){for(var r,o=[],s=t;s<n;s+=3)o.push($(r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2])));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63}}),require_ieee754=__commonJS({"node_modules/ieee754/index.js"(e){init_modules_watch_stub(),e.read=function(e,t,n,r,o){var s,a,u=8*o-r-1,$=(1<<u)-1,l=$>>1,c=-7,_=n?o-1:0,p=n?-1:1,d=e[t+_];for(_+=p,s=d&(1<<-c)-1,d>>=-c,c+=u;c>0;s=256*s+e[t+_],_+=p,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=r;c>0;a=256*a+e[t+_],_+=p,c-=8);if(0===s)s=1-l;else{if(s===$)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,r),s-=l}return(d?-1:1)*a*Math.pow(2,s-r)},e.write=function(e,t,n,r,o,s){var a,u,$,l=8*s-o-1,c=(1<<l)-1,_=c>>1,p=23===o?5960464477539062e-23:0,d=r?0:s-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*($=Math.pow(2,-a))<1&&(a--,$*=2),a+_>=1?t+=p/$:t+=p*Math.pow(2,1-_),t*$>=2&&(a++,$/=2),a+_>=c?(u=0,a=c):a+_>=1?(u=(t*$-1)*Math.pow(2,o),a+=_):(u=t*Math.pow(2,_-1)*Math.pow(2,o),a=0));o>=8;e[n+d]=255&u,d+=h,u/=256,o-=8);for(a=a<<o|u,l+=o;l>0;e[n+d]=255&a,d+=h,a/=256,l-=8);e[n+d-h]|=128*g}}}),require_buffer=__commonJS({"node_modules/buffer/index.js"(e){"use strict";init_modules_watch_stub();var t=require_base64_js(),n=require_ieee754(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return $(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function e(t,n){if(("string"!=typeof n||""===n)&&(n="utf8"),!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);let r=0|p(t,n),a=o(r),u=a.write(t,n);return u!==r&&(a=a.slice(0,u)),a}(e,t);if(ArrayBuffer.isView(e))return function e(t){if(Q(t,Uint8Array)){let n=new Uint8Array(t);return c(n.buffer,n.byteOffset,n.byteLength)}return l(t)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,ArrayBuffer)||e&&Q(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(Q(e,SharedArrayBuffer)||e&&Q(e.buffer,SharedArrayBuffer)))return c(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);let a=function e(t){if(s.isBuffer(t)){let n=0|_(t.length),r=o(n);return 0===r.length||t.copy(r,0,0,n),r}if(void 0!==t.length){var a;return"number"!=typeof t.length||(a=t.length,a!=a)?o(0):l(t)}if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function $(e){return u(e),o(e<0?0:0|_(e))}function l(e){let t=e.length<0?0:0|_(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function c(e,t,n){if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');let r;return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),s.prototype),r}function _(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(o)return r?-1:G(e).length;t=(""+t).toLowerCase(),o=!0}}function d(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function h(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){var a;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),a=n=+n,a!=a&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return -1;n=e.length-1}else if(n<0){if(!o)return -1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,o);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,o);throw TypeError("val must be string, number or Buffer")}function m(e,t,n,r,o){let s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;s=2,a/=2,u/=2,n/=2}function $(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}let l;if(o){let c=-1;for(l=n;l<a;l++)if($(e,l)===$(t,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===u)return c*s}else -1!==c&&(l-=l-c),c=-1}else for(n+u>a&&(n=a-u),l=n;l>=0;l--){let _=!0;for(let p=0;p<u;p++)if($(e,l+p)!==$(t,p)){_=!1;break}if(_)return l}return -1}function y(e,t,n,r){n=Number(n)||0;let o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;let s=t.length;r>s/2&&(r=s/2);let a;for(a=0;a<r;++a){var u;let $=parseInt(t.substr(2*a,2),16);if(u=$,u!=u)break;e[n+a]=$}return a}function b(e,t,n,r){return V(G(t,e.length-n),e,n,r)}function C(e,t,n,r){return V(function e(t){let n=[];for(let r=0;r<t.length;++r)n.push(255&t.charCodeAt(r));return n}(t),e,n,r)}function w(e,t,n,r){return V(q(t),e,n,r)}function v(e,t,n,r){return V(function e(t,n){let r,o,s,a=[];for(let u=0;u<t.length&&!((n-=2)<0);++u)o=(r=t.charCodeAt(u))>>8,s=r%256,a.push(s),a.push(o);return a}(t,e.length-n),e,n,r)}function E(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function A(e,t,n){n=Math.min(e.length,n);let r=[],o=t;for(;o<n;){let s=e[o],a=null,u=s>239?4:s>223?3:s>191?2:1;if(o+u<=n){let $,l,c,_;switch(u){case 1:s<128&&(a=s);break;case 2:(192&($=e[o+1]))==128&&(_=(31&s)<<6|63&$)>127&&(a=_);break;case 3:$=e[o+1],l=e[o+2],(192&$)==128&&(192&l)==128&&(_=(15&s)<<12|(63&$)<<6|63&l)>2047&&(_<55296||_>57343)&&(a=_);break;case 4:$=e[o+1],l=e[o+2],c=e[o+3],(192&$)==128&&(192&l)==128&&(192&c)==128&&(_=(15&s)<<18|(63&$)<<12|(63&l)<<6|63&c)>65535&&_<1114112&&(a=_)}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return function e(t){let n=t.length;if(n<=4096)return String.fromCharCode.apply(String,t);let r="",o=0;for(;o<n;)r+=String.fromCharCode.apply(String,t.slice(o,o+=4096));return r}(r)}function k(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function S(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function T(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let o="";for(let s=t;s<n;++s)o+=X[e[s]];return o}function L(e,t,n){let r=e.slice(t,n),o="";for(let s=0;s<r.length-1;s+=2)o+=String.fromCharCode(r[s]+256*r[s+1]);return o}function I(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function O(e,t,n,r,o,a){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function P(e,t,n,r,o){M(t,r,o,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function N(e,t,n,r,o){M(t,r,o,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function B(e,t,n,r,o,s){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function R(e,t,r,o,s){return t=+t,r>>>=0,s||B(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,o,23,4),r+4}function F(e,t,r,o,s){return t=+t,r>>>=0,s||B(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,o,52,8),r+8}e.Buffer=s,e.SlowBuffer=function e(t){return+t!=t&&(t=0),s.alloc(+t)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function e(){try{let t=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(t,n),42===t.foo()}catch(r){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){var r,s,a;return r=e,s=t,a=n,(u(r),r<=0)?o(r):void 0!==s?"string"==typeof a?o(r).fill(s,a):o(r).fill(s):o(r)},s.allocUnsafe=function(e){return $(e)},s.allocUnsafeSlow=function(e){return $(e)},s.isBuffer=function e(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function e(t,n){if(Q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),Q(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(t)||!s.isBuffer(n))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===n)return 0;let r=t.length,o=n.length;for(let a=0,u=Math.min(r,o);a<u;++a)if(t[a]!==n[a]){r=t[a],o=n[a];break}return r<o?-1:o<r?1:0},s.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function e(t,n){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let r;if(void 0===n)for(r=0,n=0;r<t.length;++r)n+=t[r].length;let o=s.allocUnsafe(n),a=0;for(r=0;r<t.length;++r){let u=t[r];if(Q(u,Uint8Array))a+u.length>o.length?(s.isBuffer(u)||(u=s.from(u)),u.copy(o,a)):Uint8Array.prototype.set.call(o,u,a);else if(s.isBuffer(u))u.copy(o,a);else throw TypeError('"list" argument must be an Array of Buffers');a+=u.length}return o},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function e(){let t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)h(this,n,n+1);return this},s.prototype.swap32=function e(){let t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)h(this,n,n+3),h(this,n+1,n+2);return this},s.prototype.swap64=function e(){let t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)h(this,n,n+7),h(this,n+1,n+6),h(this,n+2,n+5),h(this,n+3,n+4);return this},s.prototype.toString=function e(){let t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function e(t){if(!s.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function t(){let n="",r=e.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function e(t,n,r,o,a){if(Q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===o&&(o=0),void 0===a&&(a=this.length),n<0||r>t.length||o<0||a>this.length)throw RangeError("out of range index");if(o>=a&&n>=r)return 0;if(o>=a)return -1;if(n>=r)return 1;if(n>>>=0,r>>>=0,o>>>=0,a>>>=0,this===t)return 0;let u=a-o,$=r-n,l=Math.min(u,$),c=this.slice(o,a),_=t.slice(n,r);for(let p=0;p<l;++p)if(c[p]!==_[p]){u=c[p],$=_[p];break}return u<$?-1:$<u?1:0},s.prototype.includes=function e(t,n,r){return -1!==this.indexOf(t,n,r)},s.prototype.indexOf=function e(t,n,r){return g(this,t,n,r,!0)},s.prototype.lastIndexOf=function e(t,n,r){return g(this,t,n,r,!1)},s.prototype.write=function e(t,n,r,o){if(void 0===n)o="utf8",r=this.length,n=0;else if(void 0===r&&"string"==typeof n)o=n,r=this.length,n=0;else if(isFinite(n))n>>>=0,isFinite(r)?(r>>>=0,void 0===o&&(o="utf8")):(o=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-n;if((void 0===r||r>s)&&(r=s),t.length>0&&(r<0||n<0)||n>this.length)throw RangeError("Attempt to write outside buffer bounds");o||(o="utf8");let a=!1;for(;;)switch(o){case"hex":return y(this,t,n,r);case"utf8":case"utf-8":return b(this,t,n,r);case"ascii":case"latin1":case"binary":return C(this,t,n,r);case"base64":return w(this,t,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,t,n,r);default:if(a)throw TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),a=!0}},s.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function e(t,n){let r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),n<0?(n+=r)<0&&(n=0):n>r&&(n=r),n<t&&(n=t);let o=this.subarray(t,n);return Object.setPrototypeOf(o,s.prototype),o},s.prototype.readUintLE=s.prototype.readUIntLE=function e(t,n,r){t>>>=0,n>>>=0,r||I(t,n,this.length);let o=this[t],s=1,a=0;for(;++a<n&&(s*=256);)o+=this[t+a]*s;return o},s.prototype.readUintBE=s.prototype.readUIntBE=function e(t,n,r){t>>>=0,n>>>=0,r||I(t,n,this.length);let o=this[t+--n],s=1;for(;n>0&&(s*=256);)o+=this[t+--n]*s;return o},s.prototype.readUint8=s.prototype.readUInt8=function e(t,n){return t>>>=0,n||I(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function e(t,n){return t>>>=0,n||I(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function e(t,n){return t>>>=0,n||I(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function e(t,n){return t>>>=0,n||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function e(t,n){return t>>>=0,n||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=z(function e(t){Y(t>>>=0,"offset");let n=this[t],r=this[t+7];(void 0===n||void 0===r)&&j(t,this.length-8);let o=n+256*this[++t]+65536*this[++t]+16777216*this[++t],s=this[++t]+256*this[++t]+65536*this[++t]+16777216*r;return BigInt(o)+(BigInt(s)<<BigInt(32))}),s.prototype.readBigUInt64BE=z(function e(t){Y(t>>>=0,"offset");let n=this[t],r=this[t+7];(void 0===n||void 0===r)&&j(t,this.length-8);let o=16777216*n+65536*this[++t]+256*this[++t]+this[++t],s=16777216*this[++t]+65536*this[++t]+256*this[++t]+r;return(BigInt(o)<<BigInt(32))+BigInt(s)}),s.prototype.readIntLE=function e(t,n,r){t>>>=0,n>>>=0,r||I(t,n,this.length);let o=this[t],s=1,a=0;for(;++a<n&&(s*=256);)o+=this[t+a]*s;return o>=(s*=128)&&(o-=Math.pow(2,8*n)),o},s.prototype.readIntBE=function e(t,n,r){t>>>=0,n>>>=0,r||I(t,n,this.length);let o=n,s=1,a=this[t+--o];for(;o>0&&(s*=256);)a+=this[t+--o]*s;return a>=(s*=128)&&(a-=Math.pow(2,8*n)),a},s.prototype.readInt8=function e(t,n){return(t>>>=0,n||I(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},s.prototype.readInt16LE=function e(t,n){t>>>=0,n||I(t,2,this.length);let r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function e(t,n){t>>>=0,n||I(t,2,this.length);let r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function e(t,n){return t>>>=0,n||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function e(t,n){return t>>>=0,n||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=z(function e(t){Y(t>>>=0,"offset");let n=this[t],r=this[t+7];(void 0===n||void 0===r)&&j(t,this.length-8);let o=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(o)<<BigInt(32))+BigInt(n+256*this[++t]+65536*this[++t]+16777216*this[++t])}),s.prototype.readBigInt64BE=z(function e(t){Y(t>>>=0,"offset");let n=this[t],r=this[t+7];(void 0===n||void 0===r)&&j(t,this.length-8);let o=(n<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(o)<<BigInt(32))+BigInt(16777216*this[++t]+65536*this[++t]+256*this[++t]+r)}),s.prototype.readFloatLE=function e(t,r){return t>>>=0,r||I(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function e(t,r){return t>>>=0,r||I(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function e(t,r){return t>>>=0,r||I(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function e(t,r){return t>>>=0,r||I(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function e(t,n,r,o){if(t=+t,n>>>=0,r>>>=0,!o){let s=Math.pow(2,8*r)-1;O(this,t,n,r,s,0)}let a=1,u=0;for(this[n]=255&t;++u<r&&(a*=256);)this[n+u]=t/a&255;return n+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function e(t,n,r,o){if(t=+t,n>>>=0,r>>>=0,!o){let s=Math.pow(2,8*r)-1;O(this,t,n,r,s,0)}let a=r-1,u=1;for(this[n+a]=255&t;--a>=0&&(u*=256);)this[n+a]=t/u&255;return n+r},s.prototype.writeUint8=s.prototype.writeUInt8=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,1,255,0),this[n]=255&t,n+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,2,65535,0),this[n]=255&t,this[n+1]=t>>>8,n+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,2,65535,0),this[n]=t>>>8,this[n+1]=255&t,n+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,4,4294967295,0),this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t,n+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,4,4294967295,0),this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t,n+4},s.prototype.writeBigUInt64LE=z(function e(t,n=0){return P(this,t,n,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=z(function e(t,n=0){return N(this,t,n,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function e(t,n,r,o){if(t=+t,n>>>=0,!o){let s=Math.pow(2,8*r-1);O(this,t,n,r,s-1,-s)}let a=0,u=1,$=0;for(this[n]=255&t;++a<r&&(u*=256);)t<0&&0===$&&0!==this[n+a-1]&&($=1),this[n+a]=(t/u>>0)-$&255;return n+r},s.prototype.writeIntBE=function e(t,n,r,o){if(t=+t,n>>>=0,!o){let s=Math.pow(2,8*r-1);O(this,t,n,r,s-1,-s)}let a=r-1,u=1,$=0;for(this[n+a]=255&t;--a>=0&&(u*=256);)t<0&&0===$&&0!==this[n+a+1]&&($=1),this[n+a]=(t/u>>0)-$&255;return n+r},s.prototype.writeInt8=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,1,127,-128),t<0&&(t=255+t+1),this[n]=255&t,n+1},s.prototype.writeInt16LE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,2,32767,-32768),this[n]=255&t,this[n+1]=t>>>8,n+2},s.prototype.writeInt16BE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,2,32767,-32768),this[n]=t>>>8,this[n+1]=255&t,n+2},s.prototype.writeInt32LE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,4,2147483647,-2147483648),this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24,n+4},s.prototype.writeInt32BE=function e(t,n,r){return t=+t,n>>>=0,r||O(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t,n+4},s.prototype.writeBigInt64LE=z(function e(t,n=0){return P(this,t,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=z(function e(t,n=0){return N(this,t,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function e(t,n,r){return R(this,t,n,!0,r)},s.prototype.writeFloatBE=function e(t,n,r){return R(this,t,n,!1,r)},s.prototype.writeDoubleLE=function e(t,n,r){return F(this,t,n,!0,r)},s.prototype.writeDoubleBE=function e(t,n,r){return F(this,t,n,!1,r)},s.prototype.copy=function e(t,n,r,o){if(!s.isBuffer(t))throw TypeError("argument should be a Buffer");if(r||(r=0),o||0===o||(o=this.length),n>=t.length&&(n=t.length),n||(n=0),o>0&&o<r&&(o=r),o===r||0===t.length||0===this.length)return 0;if(n<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(o<0)throw RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-n<o-r&&(o=t.length-n+r);let a=o-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(n,r,o):Uint8Array.prototype.set.call(t,this.subarray(r,o),n),a},s.prototype.fill=function e(t,n,r,o){if("string"==typeof t){if("string"==typeof n?(o=n,n=0,r=this.length):"string"==typeof r&&(o=r,r=this.length),void 0!==o&&"string"!=typeof o)throw TypeError("encoding must be a string");if("string"==typeof o&&!s.isEncoding(o))throw TypeError("Unknown encoding: "+o);if(1===t.length){let a=t.charCodeAt(0);("utf8"===o&&a<128||"latin1"===o)&&(t=a)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(n<0||this.length<n||this.length<r)throw RangeError("Out of range index");if(r<=n)return this;n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);let u;if("number"==typeof t)for(u=n;u<r;++u)this[u]=t;else{let $=s.isBuffer(t)?t:s.from(t,o),l=$.length;if(0===l)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(u=0;u<r-n;++u)this[u+n]=$[u%l]}return this};var U={};function H(e,t,n){U[e]=class r extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function D(e){let t="",n=e.length,r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function M(e,t,n,r,o,s){var a,u,$;if(e>n||e<t){let l="bigint"==typeof t?"n":"",c;throw c=s>3?0===t||t===BigInt(0)?`>= 0${l} and < 2${l} ** ${(s+1)*8}${l}`:`>= -(2${l} ** ${(s+1)*8-1}${l}) and < 2 ** ${(s+1)*8-1}${l}`:`>= ${t}${l} and <= ${n}${l}`,new U.ERR_OUT_OF_RANGE("value",c,e)}a=r,u=o,$=s,Y(u,"offset"),(void 0===a[u]||void 0===a[u+$])&&j(u,a.length-($+1))}function Y(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function j(e,t,n){if(Math.floor(e)!==e)throw Y(e,n),new U.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}H("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),H("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),H("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>4294967296?o=D(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=D(o)),o+="n"),r+=` It must be ${t}. Received ${o}`},RangeError);var W=/[^+/0-9A-Za-z-_]/g;function G(e,t){t=t||1/0;let n,r=e.length,o=null,s=[];for(let a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319||a+1===r){(t-=3)>-1&&s.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return s}function q(e){return t.toByteArray(function e(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(e))}function V(e,t,n,r){let o;for(o=0;o<r&&!(o+n>=t.length)&&!(o>=e.length);++o)t[o+n]=e[o];return o}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var X=function(){let e="0123456789abcdef",t=Array(256);for(let n=0;n<16;++n){let r=16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function z(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw Error("BigInt not supported")}}});init_modules_watch_stub(),init_modules_watch_stub();import{connect as e}from"cloudflare:sockets";init_modules_watch_stub();var import_sha224=__toESM(require_sha224()),import_enc_hex=__toESM(require_enc_hex());init_modules_watch_stub(),init_modules_watch_stub(),init_modules_watch_stub(),init_modules_watch_stub();var regex_default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(e){return"string"==typeof e&&regex_default.test(e)}var validate_default=validate,byteToHex=[];for(let i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(e,t=0){return byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]}function parse(e){if(!validate_default(e))throw TypeError("Invalid UUID");let t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}init_modules_watch_stub(),init_modules_watch_stub();var parse_default=parse;function stringToBytes(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL2="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(e,t,n){function r(e,r,o,s){var a;if("string"==typeof e&&(e=stringToBytes(e)),"string"==typeof r&&(r=parse_default(r)),(null===(a=r)||void 0===a?void 0:a.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(r),u.set(e,r.length),(u=n(u))[6]=15&u[6]|t,u[8]=63&u[8]|128,o){s=s||0;for(let $=0;$<16;++$)o[s+$]=u[$];return o}return unsafeStringify(u)}try{r.name=e}catch(o){}return r.DNS=DNS,r.URL=URL2,r}function f(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function ROTL(e,t){return e<<t|e>>>32-t}function sha1(e){let t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){let r=unescape(encodeURIComponent(e));e=[];for(let o=0;o<r.length;++o)e.push(r.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let s=e.length/4+2,a=Math.ceil(s/16),u=Array(a);for(let $=0;$<a;++$){let l=new Uint32Array(16);for(let c=0;c<16;++c)l[c]=e[64*$+4*c]<<24|e[64*$+4*c+1]<<16|e[64*$+4*c+2]<<8|e[64*$+4*c+3];u[$]=l}u[a-1][14]=(e.length-1)*8/4294967296,u[a-1][14]=Math.floor(u[a-1][14]),u[a-1][15]=(e.length-1)*8&4294967295;for(let _=0;_<a;++_){let p=new Uint32Array(80);for(let d=0;d<16;++d)p[d]=u[_][d];for(let h=16;h<80;++h)p[h]=ROTL(p[h-3]^p[h-8]^p[h-14]^p[h-16],1);let g=n[0],m=n[1],y=n[2],b=n[3],C=n[4];for(let w=0;w<80;++w){let v=Math.floor(w/20),E=ROTL(g,5)+f(v,m,y,b)+C+t[v]+p[w]>>>0;C=b,b=y,y=ROTL(m,30)>>>0,m=g,g=E}n[0]=n[0]+g>>>0,n[1]=n[1]+m>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+C>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}init_modules_watch_stub(),init_modules_watch_stub();var sha1_default=sha1,v5=v35("v5",80,sha1_default),v5_default=v5;init_modules_watch_stub();var version="2.4",providersUri="https://raw.githubusercontent.com/vfarid/v2ray-worker/main/resources/provider-list.txt",proxiesUri="https://raw.githubusercontent.com/vfarid/v2ray-worker/main/resources/proxy-list.txt",defaultProtocols=["vmess","built-in-vless","vless","built-in-trojan"],defaultALPNList=["h3,h2,http/1.1","h3,h2,http/1.1","h3,h2,http/1.1","h3,h2","h2,http/1.1","h2","http/1.1"],defaultPFList=["chrome","firefox","randomized","safari","chrome","edge","randomized","ios","chrome","android","randomized"],cfPorts=[443,2053,2083,2087,2096,8443],fragmentsLengthList=["10-20","10-50","20-50","30-80","50-100"],fragmentsIntervalList=["10-20","10-50","20-50"],defaultClashConfig={port:7890,"socks-port":7891,"allow-lan":!1,mode:"rule","log-level":"info","external-controller":"127.0.0.1:9090",dns:{enable:!0,ipv6:!1,"enhanced-mode":"fake-ip",nameserver:["114.114.114.114","223.5.5.5","8.8.8.8","9.9.9.9","1.1.1.1","https://dns.google/dns-query","tls://dns.google:853"]},proxies:[],"proxy-groups":[],rules:["GEOIP,IR,DIRECT","DOMAIN-SUFFIX,ir,DIRECT","IP-CIDR,127.0.0.0/8,DIRECT","IP-CIDR,192.168.0.0/16,DIRECT","IP-CIDR,172.16.0.0/12,DIRECT","IP-CIDR,10.0.0.0/8,DIRECT","MATCH,All"]};function GetMultipleRandomElements(e,t){return e.sort(()=>.5-Math.random()).slice(0,t)}function IsIp(e){try{if(""==e||void 0==e||!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){2}\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-4])$/.test(e))return!1;let t=e.split(".");if(null==t||4!=t.length||"0"==t[3]||0===parseInt(t[3]))return!1;return!0}catch(n){}return!1}function IsValidUUID(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}function GetVlessConfig(e,t,n,r,o){return r.toLowerCase()==n.toLowerCase()&&(r=n),{remarks:`${e}-vless-worker-${r}`,configType:"vless",security:"tls",tls:"tls",network:"ws",port:o,sni:n,uuid:t,host:n,path:"vless-ws/?ed=2048",address:r}}function GetTrojanConfig(e,t,n,r,o){return r.toLowerCase()==n.toLowerCase()&&(r=n),{remarks:`${e}-trojan-worker-${r}`,configType:"trojan",security:"tls",tls:"tls",network:"ws",port:o,sni:n,password:t,host:n,path:"trojan-ws/?ed=2048",address:r}}function IsBase64(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/.test(e)}function RemoveDuplicateConfigs(e){let t={};return e.filter(e=>{let n=e.remarks+e.port+e.address+e.uuid;return!t[n]&&(t[n]=!0,!0)})}function AddNumberToConfigs(e,t){return e.map((e,n)=>(e.remarks=n+t+"-"+e.remarks,e))}function GenerateToken(e=32){let t=new Uint8Array(e);for(let n=0;n<e;n++)t[n]=Math.floor(256*Math.random());return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}function Delay(e){return new Promise(t=>setTimeout(t,e))}function MuddleDomain(e){let t=e.split("."),n=t.slice(0,t.length-2).join("."),r=t.slice(-2).join("."),o=r.split("").map(e=>.5>Math.random()?e.toLowerCase():e.toUpperCase()).join("");return n+"."+o}function getUUID(e){return v5_default(e.toLowerCase(),"ebc4a168-a6fe-47ce-bc25-6183c6212dcc")}function getSHA224Password(e){return(0,import_sha224.default)(e.toLowerCase()).toString(import_enc_hex.default)}var WS_READY_STATE_OPEN=1,WS_READY_STATE_CLOSING=2,proxyIP="",proxyList=[],blockPorn="",filterCountries="",countries=[];async function GetVlessConfigList(e,t,n,r,o){filterCountries="",blockPorn="",proxyList=[];let s=getUUID(e),a=[];for(let u=0;u<r;u++)a.push(GetVlessConfig(u+n,s,MuddleDomain(e),t[Math.floor(Math.random()*t.length)],cfPorts[Math.floor(Math.random()*cfPorts.length)]));return a}async function VlessOverWSHandler(e,t,n){let r=getUUID(t),[o,s]=Object.values(new WebSocketPair);s.accept();let a="",u=e.headers.get("sec-websocket-protocol")||"",$=MakeReadableWebSocketStream(s,u),l={value:null},c=null,_=!1;return $.pipeTo(new WritableStream({async write(e,t){if(_&&c)return c(e);if(l.value){let o=l.value.writable.getWriter();await o.write(e),o.releaseLock();return}let{hasError:u,message:$,addressRemote:p="",addressType:d,portRemote:h=443,rawDataIndex:g,vlessVersion:m=new Uint8Array([0,0]),isUDP:y,isMUX:b}=ProcessVlessHeader(e,r);if(a=p,u)throw Error($);if(y){if(53===h)_=!0;else throw Error("UDP proxy only enable for DNS which is port 53")}else if(b)throw Error("MUX is not supported!");let C=new Uint8Array([m[0],0]),w=e.slice(g);if(_){let{write:v}=await HandleUDPOutbound(s,C,n);(c=v)(w);return}HandleTCPOutbound(l,p,h,w,s,C,n)}})).catch(e=>{}),new Response(null,{status:101,webSocket:o})}function MakeReadableWebSocketStream(e,t){let n=!1,r=new ReadableStream({start(r){e.addEventListener("message",e=>{if(n)return;let t=e.data;r.enqueue(t)}),e.addEventListener("close",()=>{SafeCloseWebSocket(e),!n&&r.close()}),e.addEventListener("error",e=>{r.error(e)});let{earlyData:o,error:s}=Base64ToArrayBuffer(t);s?r.error(s):o&&r.enqueue(o)},cancel(t){!n&&(n=!0,SafeCloseWebSocket(e))}});return r}function ProcessVlessHeader(e,t){if(e.byteLength<24)return{hasError:!0,message:"Invalid data"};let n=new Uint8Array(e.slice(0,1)),r=!1,o=!1,s=!1;if(Stringify(new Uint8Array(e.slice(1,17)))===t&&(r=!0),!r)return{hasError:!0,message:"Invalid user"};let a=new Uint8Array(e.slice(17,18))[0],u=new Uint8Array(e.slice(18+a,18+a+1))[0];if(1===u);else if(2===u)o=!0;else{if(3!==u)return{hasError:!0,message:`Command ${u} is not support, command 01-tcp, 02-udp, 03-mux`};s=!0}let $=18+a+1,l=e.slice($,$+2),c=new DataView(l).getUint16(0),_=$+2,p=new Uint8Array(e.slice(_,_+1)),d=p[0],h=0,g=_+1,m="";switch(d){case 1:h=4,m=new Uint8Array(e.slice(g,g+h)).join(".");break;case 2:h=new Uint8Array(e.slice(g,g+1))[0],g+=1,m=new TextDecoder().decode(e.slice(g,g+h));break;case 3:h=16;let y=new DataView(e.slice(g,g+h)),b=[];for(let C=0;C<8;C++)b.push(y.getUint16(2*C).toString(16));m=b.join(":");break;default:return{hasError:!0,message:`invild  addressType is ${d}`}}return m?{hasError:!1,addressRemote:m,addressType:d,portRemote:c,rawDataIndex:g+h,vlessVersion:n,isUDP:o,isMUX:s}:{hasError:!0,message:`addressValue is empty, addressType is ${d}`}}async function HandleUDPOutbound(e,t,n){let r=!1,o=new TransformStream({transform(e,t){for(let n=0;n<e.byteLength;){let r=e.slice(n,n+2),o=new DataView(r).getUint16(0),s=new Uint8Array(e.slice(n+2,n+2+o));n=n+2+o,t.enqueue(s)}}});""==blockPorn&&(blockPorn=await n.settings.get("BlockPorn")||"no"),o.readable.pipeTo(new WritableStream({async write(n){let o=await fetch("yes"==blockPorn?"https://1.1.1.3/dns-query":"https://1.1.1.1/dns-query",{method:"POST",headers:{"content-type":"application/dns-message"},body:n}),s=await o.arrayBuffer(),a=s.byteLength,u=new Uint8Array([a>>8&255,255&a]);e.readyState===WS_READY_STATE_OPEN&&(r?e.send(await new Blob([u,s]).arrayBuffer()):(e.send(await new Blob([t,u,s]).arrayBuffer()),r=!0))}})).catch(e=>{});let s=o.writable.getWriter();return{write(e){s.write(e)}}}async function HandleTCPOutbound(t,n,r,o,s,a,u){let $=0;async function l(n,r){let s=e({hostname:n,port:r},{allowHalfOpen:!1});t.value=s;let a=s.writable.getWriter();return await a.write(o),a.releaseLock(),s}async function c(){if(!(++$>5)&&(proxyList.length||(countries=(await u.settings.get("Countries"))?.split(",").filter(e=>e.trim().length>0)||[],proxyList=await fetch(proxiesUri).then(e=>e.text()).then(e=>e.trim().split("\n").filter(e=>e.trim().length>0)),countries.length>0&&(proxyList=proxyList.filter(e=>{let t=e.split(",");if(t.length>0)return countries.includes(t[1])})),proxyList=proxyList.map(e=>e.split(",")[0]),console.log(proxyList)),proxyList.length>0)){proxyIP=proxyList[Math.floor(Math.random()*proxyList.length)];let e=await l(proxyIP,r);RemoteSocketToWS(e,s,a,c)}}let _=await l(n,r);RemoteSocketToWS(_,s,a,c)}async function RemoteSocketToWS(e,t,n,r){let o=n,s=!1;await e.readable.pipeTo(new WritableStream({async write(e,n){try{s=!0,t.readyState!==WS_READY_STATE_OPEN&&n.error("webSocket.readyState is not open, maybe close"),o?(t.send(await new Blob([o,e]).arrayBuffer()),o=null):t.send(e)}catch(r){}},abort(e){}})).catch(e=>{SafeCloseWebSocket(t)}),!1===s&&r&&r()}function SafeCloseWebSocket(e){try{(e.readyState===WS_READY_STATE_OPEN||e.readyState===WS_READY_STATE_CLOSING)&&e.close()}catch(t){}}function Base64ToArrayBuffer(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");let t=atob(e),n=Uint8Array.from(t,e=>e.charCodeAt(0));return{earlyData:n.buffer,error:null}}catch(r){return{earlyData:null,error:r}}}function IsValidVlessUUID(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Stringify(e,t=0){let n=UnsafeStringify(e,t);if(!IsValidVlessUUID(n))throw TypeError("Stringified UUID is invalid");return n}var byteToHex2=[];for(let i=0;i<256;++i)byteToHex2.push((i+256).toString(16).slice(1));function UnsafeStringify(e,t=0){return`${byteToHex2[e[t+0]]+byteToHex2[e[t+1]]+byteToHex2[e[t+2]]+byteToHex2[e[t+3]]}-${byteToHex2[e[t+4]]+byteToHex2[e[t+5]]}-${byteToHex2[e[t+6]]+byteToHex2[e[t+7]]}-${byteToHex2[e[t+8]]+byteToHex2[e[t+9]]}-${byteToHex2[e[t+10]]+byteToHex2[e[t+11]]+byteToHex2[e[t+12]]+byteToHex2[e[t+13]]+byteToHex2[e[t+14]]+byteToHex2[e[t+15]]}`.toLowerCase()}init_modules_watch_stub();import{connect as t}from"cloudflare:sockets";var WS_READY_STATE_OPEN2=1,WS_READY_STATE_CLOSING2=2,proxyIP2="",proxyList2=[],filterCountries2="",countries2=[];async function GetTrojanConfigList(e,t,n,r,o){filterCountries2="",proxyList2=[];let s=[];for(let a=0;a<r;a++)s.push(GetTrojanConfig(a+n,getUUID(e),MuddleDomain(e),t[Math.floor(Math.random()*t.length)],cfPorts[Math.floor(Math.random()*cfPorts.length)]));return s}async function TrojanOverWSHandler(e,t,n){let r=getSHA224Password(getUUID(t)),[o,s]=Object.values(new WebSocketPair);s.accept();let a="",u=e.headers.get("sec-websocket-protocol")||"",$=MakeReadableWebSocketStream2(s,u),l={value:null};return $.pipeTo(new WritableStream({async write(e,t){if(l.value){let o=l.value.writable.getWriter();await o.write(e),o.releaseLock();return}let{hasError:u,message:$,portRemote:c=443,addressRemote:_="",rawClientData:p}=await ParseTrojanHeader(e,r);if(a=_,u)throw Error($);HandleTCPOutbound2(l,_,c,p,s,n)}})).catch(e=>{}),new Response(null,{status:101,webSocket:o})}async function ParseTrojanHeader(e,t){if(e.byteLength<56)return{hasError:!0,message:"invalid data"};if(13!==new Uint8Array(e.slice(56,57))[0]||10!==new Uint8Array(e.slice(57,58))[0])return{hasError:!0,message:"invalid header format (missing CR LF)"};let n=new TextDecoder().decode(e.slice(0,56));if(n!==t)return{hasError:!0,message:"invalid password"};let r=e.slice(58);if(r.byteLength<6)return{hasError:!0,message:"invalid SOCKS5 request data"};let o=new DataView(r),s=o.getUint8(0);if(1!==s)return{hasError:!0,message:"unsupported command, only TCP (CONNECT) is allowed"};let a=o.getUint8(1),u=0,$=2,l="";switch(a){case 1:u=4,l=new Uint8Array(r.slice($,$+u)).join(".");break;case 3:u=new Uint8Array(r.slice($,$+1))[0],$+=1,l=new TextDecoder().decode(r.slice($,$+u));break;case 4:u=16;let c=new DataView(r.slice($,$+u)),_=[];for(let p=0;p<8;p++)_.push(c.getUint16(2*p).toString(16));l=_.join(":");break;default:return{hasError:!0,message:`invalid addressType is ${a}`}}if(!l)return{hasError:!0,message:`address is empty, addressType is ${a}`};let d=$+u,h=r.slice(d,d+2),g=new DataView(h).getUint16(0);return{hasError:!1,addressRemote:l,portRemote:g,rawClientData:r.slice(d+4)}}async function HandleTCPOutbound2(e,n,r,o,s,a){let u=0;async function $(n,r){let s=t({hostname:n,port:r});e.value=s;let a=s.writable.getWriter();return await a.write(o),a.releaseLock(),s}async function l(){if(!(++u>5)&&(proxyList2.length||(countries2=(await a.settings.get("Countries"))?.split(",").filter(e=>e.trim().length>0)||[],proxyList2=await fetch(proxiesUri).then(e=>e.text()).then(e=>e.trim().split("\n").filter(e=>e.trim().length>0)),countries2.length>0&&(proxyList2=proxyList2.filter(e=>{let t=e.split(",");if(t.length>0)return countries2.includes(t[1])})),proxyList2=proxyList2.map(e=>e.split(",")[0])),proxyList2.length>0)){proxyIP2=proxyList2[Math.floor(Math.random()*proxyList2.length)];let e=await $(proxyIP2,r);RemoteSocketToWS2(e,s,l)}}let c=await $(n,r);RemoteSocketToWS2(c,s,l)}function MakeReadableWebSocketStream2(e,t){let n=!1,r=new ReadableStream({start(r){e.addEventListener("message",e=>{if(n)return;let t=e.data;r.enqueue(t)}),e.addEventListener("close",()=>{SafeCloseWebSocket2(e),!n&&r.close()}),e.addEventListener("error",e=>{r.error(e)});let{earlyData:o,error:s}=Base64ToArrayBuffer2(t);s?r.error(s):o&&r.enqueue(o)},pull(e){},cancel(t){!n&&(n=!0,SafeCloseWebSocket2(e))}});return r}async function RemoteSocketToWS2(e,t,n){let r=!1;await e.readable.pipeTo(new WritableStream({async write(e,n){try{r=!0,t.readyState!==WS_READY_STATE_OPEN2&&n.error("webSocket.readyState is not open, maybe close"),t.send(e)}catch(o){}},abort(e){}})).catch(e=>{SafeCloseWebSocket2(t)}),!1===r&&n&&n()}function Base64ToArrayBuffer2(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");let t=atob(e),n=Uint8Array.from(t,e=>e.charCodeAt(0));return{earlyData:n.buffer,error:null}}catch(r){return{earlyData:null,error:r}}}function SafeCloseWebSocket2(e){try{(e.readyState===WS_READY_STATE_OPEN2||e.readyState===WS_READY_STATE_CLOSING2)&&e.close()}catch(t){}}init_modules_watch_stub();var bcrypt=__toESM(require_bcrypt());async function GetPanel(e,t){let n=new URL(e.url);try{let r=await t.settings.get("Password"),o=await t.settings.get("Token");if(r&&n.searchParams.get("token")!=o)return Response.redirect(`${n.origin}/login`,302);let s=await t.settings.get("Version")||"2.0";s!=version&&(await t.settings.delete("Providers"),await t.settings.delete("Protocols"));let a=parseInt(await t.settings.get("MaxConfigs")||"200"),u=(await t.settings.get("Protocols"))?.split("\n").filter(e=>e.trim().length>0)||defaultProtocols,$=(await t.settings.get("ALPNs"))?.split("\n").filter(e=>e.trim().length>0)||[],l=(await t.settings.get("FingerPrints"))?.split("\n").filter(e=>e.trim().length>0)||[],c=(await t.settings.get("CleanDomainIPs"))?.split("\n").filter(e=>e.trim().length>0)||[],_=(await t.settings.get("Configs"))?.split("\n").filter(e=>e.trim().length>0)||[],p=await t.settings.get("IncludeOriginalConfigs")||"yes",d=await t.settings.get("IncludeMergedConfigs")||"yes",h=await t.settings.get("EnableFragments")||"no",g=await t.settings.get("BlockPorn")||"no",m=(await t.settings.get("Providers"))?.split("\n").filter(e=>e.trim().length>0)||[],y=(await t.settings.get("Countries"))?.split(",").filter(e=>e.trim().length>0)||[],b=await fetch(proxiesUri).then(e=>e.text()).then(e=>e.trim().split("\n").map(e=>{let t=e.split(",");return t.length>0?t[1]?.toString().trim().toUpperCase():""}).filter(e=>e));b=[...new Set(b)].sort();let C="",w=n.searchParams.get("message");"success"==w?C='<div class="p-1 bg-success text-white fw-bold text-center">Settings saved successfully.<br/>\\u062A\\u0646\\u0638\\u06CC\\u0645\\u0627\\u062A \\u0628\\u0627 \\u0645\\u0648\\u0641\\u0642\\u06CC\\u062A \\u0630\\u062E\\u06CC\\u0631\\u0647 \\u0634\\u062F.</div>':"error"==w&&(C='<div class="p-1 bg-danger text-white fw-bold text-center">Failed to save settings!<br/>\\u062E\\u0637\\u0627 \\u062F\\u0631 \\u0630\\u062E\\u06CC\\u0631\\u0647\\u200C\\u06CC \\u062A\\u0646\\u0638\\u06CC\\u0645\\u0627\\u062A!</div>');let v="",E=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf8" />
      <link rel="shortcut icon" type="image/ico" href="https://dash.cloudflare.com/favicon.ico" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" rel="stylesheet" />
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
      <script>
        let language = localStorage.getItem("lang") || "fa"
        window.addEventListener("load", (event) => {
          initLang();
          setLang(language);

          document.getElementById('providers-check').addEventListener("change", () => {
            if (document.getElementById('providers-check').checked) {
              document.getElementById('providers').style.display = ""
              document.getElementById('providers-remarks').style.display = ""
              document.getElementById('providers-auto-title').style.display = "none"
            } else {
              document.getElementById('providers').style.display = "none"
              document.getElementById('providers-remarks').style.display = "none"
              document.getElementById('providers-auto-title').style.display = ""
            }
          });
          document.getElementById('providers-check').dispatchEvent(new Event("change"));

          document.getElementById('countries-check').addEventListener("change", () => {
            if (document.getElementById('countries-check').checked) {
              document.getElementById('countries-div').style.display = ""
            } else {
              document.getElementById('countries-div').style.display = "none"
            }
          });
          document.getElementById('countries-check').dispatchEvent(new Event("change"));

          document.getElementById('clean-ips-check').addEventListener("change", () => {
            if (document.getElementById('clean-ips-check').checked) {
              document.getElementById('clean-ips').style.display = ""
              document.getElementById('clean-ips-remarks').style.display = ""
            } else {
              document.getElementById('clean-ips').style.display = "none"
              document.getElementById('clean-ips-remarks').style.display = "none"
            }
          });
          document.getElementById('clean-ips-check').dispatchEvent(new Event("change"));

          document.getElementById('configs-check').addEventListener("change", () => {
            if (document.getElementById('configs-check').checked) {
              document.getElementById('configs').style.display = ""
              document.getElementById('personal-configs-remarks').style.display = ""
            } else {
              document.getElementById('configs').style.display = "none"
              document.getElementById('personal-configs-remarks').style.display = "none"
            }
          });
          document.getElementById('configs-check').dispatchEvent(new Event("change"));

          document.getElementById('fp-list-check').addEventListener("change", () => {
            if (document.getElementById('fp-list-check').checked) {
              document.getElementById('fp-list').style.display = ""
              document.getElementById('fp-list-remarks').style.display = ""
            } else {
              document.getElementById('fp-list').style.display = "none"
              document.getElementById('fp-list-remarks').style.display = "none"
            }
          });
          document.getElementById('fp-list-check').dispatchEvent(new Event("change"));

          document.getElementById('alpn-list-check').addEventListener("change", () => {
            if (document.getElementById('alpn-list-check').checked) {
              document.getElementById('alpn-list').style.display = ""
              document.getElementById('alpn-list-remarks').style.display = ""
            } else {
              document.getElementById('alpn-list').style.display = "none"
              document.getElementById('alpn-list-remarks').style.display = "none"
            }
          });
          document.getElementById('alpn-list-check').dispatchEvent(new Event("change"));
        });
        window.addEventListener('message', function (event) {
          if (event.data?.cleanIPs) {
            document.getElementById('clean-ips').value = event.data.cleanIPs;
          }
        });
    
        function initLang() {
          document.getElementById("lang-group").innerHTML = ""
          for (code in strings) {
            const el = document.createElement("button")
            el.classList = "btn btn-outline-primary btn-sm rounded-2"
            el.id = \`btn-\${code}\`
            el.type = "button"
            el.innerText = code.toUpperCase()
            el.setAttribute("data-lang", code);
            el.addEventListener("click", (e) => {
                setLang(e.srcElement.getAttribute("data-lang"))
            })
            document.getElementById("lang-group").appendChild(el)
    
            const el2 = document.createElement("span")
            el2.innerHTML = "&nbsp;"
            document.getElementById("lang-group").appendChild(el2)
          }
        }
      
        function setLang(code) {
          if (strings[code] === undefined) {
            code = "en"
          }
          
          document.getElementById('body').style.direction = languages[code]?.dir || "ltr"
          document.getElementById('lang-group').style.float = languages[code]?.end || "left"
          document.getElementById('btn-' + language).classList.remove('btn-primary')
          document.getElementById('btn-' + language).classList.add('btn-outline-primary')
          document.getElementById('btn-' + code).classList.remove('btn-outline-primary')
          document.getElementById('btn-' + code).classList.add('btn-primary')
          
          for (key in strings[code]) {
            document.getElementById(key).innerText = strings[code][key]
          }
      
          language = code
          localStorage.setItem('lang', code);
        }
    
        const languages = {
          en: {dir: "ltr", end: "right"},
          fa: {dir: "rtl", end: "left"},
        }
      
        const strings = {
          en: {
            "page-title": "V2ray Worker Control Panel",
            "text-version": "Version",
            "sub-link-title": "Your subscription link for v2ray clients (v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box...)",
            // "custom-link-title": "Your subscription link for custom configs",
            "clash-link-title": "Your subscription link for clash clients (Clash, ClashX, ClashMeta...)",
            "includes-title": "Merged and original configs",
            "include-merged-configs-title": "Include configs merged with worker",
            "include-original-configs-title": "Include original configs",
            "max-configs-title": "Max. mumber of configs",
            "protocols-title": "Protocols",
            "clean-ips-title": "Clean IP or clean subdomain",
            "clean-ips-remarks": "One IP or subdomain per line.",
            "clean-ips-btn-title": "Find clean IPs",
            "clean-ips-btn-close-title": "Close",
            "alpn-list-title": "ALPN List",
            "alpn-list-remarks": "One item per line.",
            "fp-list-title": "Fingerprint List",
            "fp-list-remarks": "One item per line.",
            "providers-title": "Config Providers",
            "providers-auto-title": "Auto load from github",
            "providers-remarks": "One link per line (base64, yaml, raw).",
            "countries-title": "Limit By Country (Only for websites beind Cloudflare Network)",
            "countries-all-title": "If you check this option, all protocols will be deactivated except built-in protocols.",
            "personal-configs-title": "Private Configs",
            "personal-configs-remarks": "One config per line.",
            "block-porn-title": "\u200CBlock Porn",
            "block-porn-remarks": "If you check this option, porn websites will be blocked and all protocols will be deactivated except built-in vless protocol.",
            "enable-fragments-title": "Enable Fragments",
            "enable-fragments-remarks": "If you check this option, fragments will be enabled for all TLS configs using random values.",
            "save-button": "Save",
            "reset-button": "Reset",
          },
          fa: {
            "page-title": "\u067E\u0646\u0644 \u06A9\u0646\u062A\u0631\u0644 \u0648\u0631\u06A9\u0631 v2ray",
            "text-version": "\u0646\u0633\u062E\u0647",
            "sub-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0644\u0627\u06CC\u0646\u062A\u200C\u0647\u0627\u06CC v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box \u0648...",
            // "custom-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC Custom",
            "clash-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0644\u0627\u06CC\u0646\u062A\u200C\u0647\u0627\u06CC \u06A9\u0644\u0634 Clash, ClashX, ClashMeta \u0648...",
            "includes-title": "\u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC \u0627\u0635\u0644\u06CC \u0648 \u062A\u0631\u06A9\u06CC\u0628\u06CC",
            "include-merged-configs-title": "\u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC \u062A\u0631\u06A9\u06CC\u0628 \u0634\u062F\u0647 \u0628\u0627 \u0648\u0631\u06A9\u0631 \u0631\u0627 \u0627\u0636\u0627\u0641\u0647 \u06A9\u0646",
            "include-original-configs-title": "\u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC \u0627\u0635\u0644\u06CC \u0631\u0627 \u0627\u0636\u0627\u0641\u0647 \u06A9\u0646",
            "max-configs-title": "\u062D\u062F\u0627\u06A9\u062B\u0631 \u062A\u0639\u062F\u0627\u062F \u06A9\u0627\u0646\u0641\u06CC\u06AF",
            "protocols-title": "\u067E\u0631\u0648\u062A\u06A9\u0644\u200C\u0647\u0627",
            "clean-ips-title": "\u0622\u06CC\u200C\u067E\u06CC \u062A\u0645\u06CC\u0632 \u06CC\u0627 \u0633\u0627\u0628\u200C\u062F\u0627\u0645\u06CC\u0646 \u0622\u06CC\u200C\u067E\u06CC \u062A\u0645\u06CC\u0632",
            "clean-ips-remarks": "\u062F\u0631 \u0647\u0631 \u0633\u0637\u0631 \u06CC\u06A9 \u0622\u06CC\u200C\u067E\u06CC \u06CC\u0627 \u0633\u0627\u0628\u200C\u062F\u0627\u0645\u06CC\u0646 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F.",
            "clean-ips-btn-title": "\u067E\u06CC\u062F\u0627 \u06A9\u0631\u062F\u0646 \u0622\u06CC\u200C\u067E\u06CC \u062A\u0645\u06CC\u0632",
            "clean-ips-btn-close-title": "\u0628\u0633\u062A\u0646",
            "alpn-list-title": "\u0644\u06CC\u0633\u062A ALPN \u0647\u0627",
            "alpn-list-remarks": "\u062F\u0631 \u0647\u0631 \u0633\u0637\u0631 \u06CC\u06A9 \u0622\u06CC\u062A\u0645 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F.",
            "fp-list-title": "\u0644\u06CC\u0633\u062A \u0641\u06CC\u0646\u06AF\u0631\u067E\u0631\u06CC\u0646\u062A\u200C\u0647\u0627",
            "fp-list-remarks": "\u062F\u0631 \u0647\u0631 \u0633\u0637\u0631 \u06CC\u06A9 \u0622\u06CC\u062A\u0645 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F.",
            "providers-title": "\u062A\u0627\u0645\u06CC\u0646 \u06A9\u0646\u0646\u062F\u06AF\u0627\u0646 \u06A9\u0627\u0646\u0641\u06CC\u06AF",
            "providers-auto-title": "\u062F\u0631\u06CC\u0627\u0641\u062A \u062E\u0648\u062F\u06A9\u0627\u0631 \u0627\u0632 \u06AF\u06CC\u062A\u200C\u0647\u0627\u0628",
            "providers-remarks": "\u062F\u0631 \u0647\u0631 \u0633\u0637\u0631 \u06CC\u06A9 \u0644\u06CC\u0646\u06A9 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F (base64, yaml, raw).",
            "countries-title": "\u0645\u062D\u062F\u0648\u062F \u06A9\u0631\u062F\u0646 \u06A9\u0634\u0648\u0631 (\u0641\u0642\u0637 \u0628\u0631\u0627\u06CC \u0648\u0628\u0633\u0627\u06CC\u062A\u200C\u0647\u0627\u06CC \u067E\u0634\u062A \u0634\u0628\u06A9\u0647 \u06A9\u0644\u0627\u062F\u0641\u0644\u0631)",
            "countries-all-title": "\u062F\u0631 \u0635\u0648\u0631\u062A \u0641\u0639\u0627\u0644\u200C\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646 \u06AF\u0632\u06CC\u0646\u0647\u060C \u062A\u0645\u0627\u0645 \u067E\u0631\u0648\u062A\u06A9\u0644\u200C\u0647\u0627 \u0628\u062C\u0632 \u067E\u0631\u0648\u062A\u06A9\u0644\u200C\u0647\u0627\u06CC \u062F\u0627\u062E\u0644\u06CC \u0648\u0631\u06A9\u0631 \u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u0645\u06CC\u200C\u0634\u0648\u0646\u062F.",
            "personal-configs-title": "\u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC \u062E\u0635\u0648\u0635\u06CC",
            "personal-configs-remarks": "\u062F\u0631 \u0647\u0631 \u0633\u0637\u0631 \u06CC\u06A9 \u06A9\u0627\u0646\u0641\u06CC\u06AF \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F.",
            "block-porn-title": "\u0645\u0633\u062F\u0648\u062F\u0633\u0627\u0632\u06CC \u067E\u0648\u0631\u0646",
            "block-porn-remarks": "\u062F\u0631 \u0635\u0648\u0631\u062A \u0641\u0639\u0627\u0644\u200C\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646 \u06AF\u0632\u06CC\u0646\u0647\u060C \u0647\u0645\u0632\u0645\u0627\u0646 \u0628\u0627 \u0645\u0633\u062F\u0648\u062F\u0633\u0627\u0632\u06CC \u067E\u0648\u0631\u0646 \u062A\u0645\u0627\u0645 \u067E\u0631\u0648\u062A\u06A9\u0644\u200C\u0647\u0627 \u0628\u062C\u0632 vless \u0647\u0627\u06CC \u062F\u0627\u062E\u0644\u06CC \u0648\u0631\u06A9\u0631 \u0646\u06CC\u0632 \u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u0645\u06CC\u200C\u0634\u0648\u0646\u062F.",
            "enable-fragments-title": "\u0641\u0639\u0627\u0644\u200C\u0633\u0627\u0632\u06CC \u0641\u0631\u06AF\u0645\u0646\u062A",
            "enable-fragments-remarks": "\u062F\u0631 \u0635\u0648\u0631\u062A \u0641\u0639\u0627\u0644\u200C\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646 \u06AF\u0632\u06CC\u0646\u0647\u060C \u0641\u0631\u06AF\u0645\u0646\u062A \u0628\u0631\u0627\u06CC \u062A\u0645\u0627\u0645 \u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC TLS \u0628\u0627 \u0645\u0642\u0627\u062F\u06CC\u0631 \u0627\u062A\u0641\u0627\u0642\u06CC \u0641\u0639\u0627\u0644 \u0645\u06CC\u200C\u0634\u0648\u062F.",
            "save-button": "\u0630\u062E\u06CC\u0631\u0647",
            "reset-button": "\u0628\u0627\u0632\u0646\u0634\u0627\u0646\u06CC",
          },
        }
      </script>
    </head>
    <body id="body" style="--bs-body-font-size: .875rem">
      <div class="container border mt-3 p-0 border-primary border-2 rounded">
        <div id="lang-group" class="btn-group m-2" role="group" dir="ltr"></div>
        <div class="p-2 border-bottom border-primary border-2">
          <div class="text-nowrap fs-5 fw-bold text-dark">
            <span id="page-title"></span> &nbsp;&nbsp;<span class="text-nowrap fs-6 text-info"><span id="text-version"></span> ${version}</span>
          </div>
        </div>
        ${C}
        <div class="px-4 py-2 bg-light">
          <label id="sub-link-title" for="sub-link" class="form-label fw-bold"></label>
          <input id="sub-link" readonly value="${n.origin}/sub" class="p-1" style="width: calc(100% - 150px)">
          <button onclick="let tmp=document.getElementById('sub-link');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>
        </div>
        <div class="px-4 py-2 bg-light">
          <label id="clash-link-title" for="clash-link" class="form-label fw-bold"></label>
          <input id="clash-link" readonly value="${n.origin}/clash" class="p-1" style="width: calc(100% - 150px)">
          <button onclick="let tmp=document.getElementById('clash-link');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>
        </div>
        <form class="px-4 py-4 border-top border-2 border-primary" method="post">
          <div class="mb-1 p-1">
            <label id="includes-title" class="form-label fw-bold"></label>
            <div id="includes">
              <div>
                <input type="checkbox" name="merged" value="yes" class="form-check-input" id="merged-ckeck" ${"yes"==d?"checked":""}>
                <label id="include-merged-configs-title" class="form-check-label" for="merged-ckeck"></label>
              </div>
              <div>
                <input type="checkbox" name="original" value="yes" class="form-check-input" id="original-ckeck" ${"yes"==p?"checked":""}>
                <label id="include-original-configs-title" class="form-check-label" for="original-ckeck"></label>
              </div>
            </div>
          </div>
          <div class="mb-1 p-1">
            <label id="max-configs-title" for="max-configs" class="form-label fw-bold"></label>
            <input type="number" name="max" class="form-control" id="max-configs" value="${a}" min="50"/>
            <div class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <label id="protocols-title" class="form-label fw-bold"></label>
            <div id="type">
              <div>
                <input type="checkbox" name="protocols" value="vmess" class="form-check-input" id="vmess-protocol-ckeck" ${u.includes("vmess")?"checked":""} />
                <label class="form-check-label" for="vmess-protocol-ckeck">VMESS</label>
              </div>
              <div>
                <input type="checkbox" name="protocols" value="vless" class="form-check-input" id="vless-protocol-ckeck" ${u.includes("vless")?"checked":""} />
                <label class="form-check-label" for="vless-protocol-ckeck">VLESS</label>
              </div>
              <div>
                <input type="checkbox" name="protocols" value="built-in-vless" class="form-check-input" id="built-in-vless-protocol-ckeck" ${u.includes("built-in-vless")?"checked":""} />
                <label class="form-check-label" for="built-in-vless-protocol-ckeck">Built-in VLESS</label>
              </div>
              <div>
                <input type="checkbox" name="protocols" value="built-in-trojan" class="form-check-input" id="built-in-trojan-protocol-ckeck" ${u.includes("built-in-trojan")?"checked":""} />
                <label class="form-check-label" for="built-in-trojan-protocol-ckeck">Built-in Trojan</label>
              </div>
            </div>
          </div>
          <div class="mb-1 p-1 border-top border-2 border-primary">
            <input type="checkbox" class="form-check-input" name="clean_ips_check" value="1" id="clean-ips-check" ${c.length?"checked":""}>
            <label id="clean-ips-title" for="clean-ips-check" class="form-label fw-bold"></label>
            <textarea rows="5" name="clean_ips" style="display: none" class="form-control" id="clean-ips">${c.join("\n")}</textarea>
            <div id="clean-ips-remarks" style="display: none" class="form-text"></div>
            <div>
              <button id="clean-ips-btn-title" type="button" style="display: none" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#ip-scanner-modal"></button>
              <div class="modal fade" id="ip-scanner-modal" tabindex="-1" aria-labelledby="ip-scanner-modal-label" aria-hidden="true">
                <div class="modal-dialog modal-xl modal-dialog-scrollable">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button id="clean-ips-btn-close-title" type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                      <iframe src="https://vfarid.github.io/cf-ip-scanner/" style="width: 100%; height: 90vh;"></iframe>
                    </div>
                  </div>
                </div>
              </div>
              </div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="enable_fragments" value="yes" id="enable-fragments" ${"yes"==h?"checked":""}>
            <label id="enable-fragments-title" for="enable-fragments" class="form-label fw-bold"></label>
            <div id="enable-fragments-remarks" class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="countries_check" value="1" id="countries-check" ${y.length?"checked":""}>
            <label id="countries-title" for="countries-check" class="form-label fw-bold"></label>
            <div id="countries-all-title" class="form-text"></div>
            <div id="countries-div" class="px-4 py-1">
              ${b.map(e=>`<input type="checkbox" class="form-check-input" id="countries-check-${e.toLowerCase()}" name="countries[]" value="${e}" ${y.length&&y.includes(e)?"checked":""}> <label for="countries-check-${e.toLowerCase()}" class="form-label">${e}</label>`).join(" &nbsp; &nbsp;")}
            </div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="block_porn" value="yes" id="block-porn" ${"yes"==g?"checked":""}>
            <label id="block-porn-title" for="block-porn" class="form-label fw-bold"></label>
            <div id="block-porn-remarks" class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="alpn_list_check" value="1" id="alpn-list-check" ${$.length?"checked":""}>
            <label id="alpn-list-title" for="alpn-list-check" class="form-label fw-bold"></label>
            <textarea rows="5" name="alpn_list" style="display: none" class="form-control" id="alpn-list">${$.join("\n")}</textarea>
            <div id="alpn-list-remarks" style="display: none" class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="fp_list_check" value="1" id="fp-list-check" ${l.length?"checked":""}>
            <label id="fp-list-title" for="fp-list-check" class="form-label fw-bold"></label>
            <textarea rows="5" name="fp_list" style="display: none" class="form-control" id="fp-list">${l.join("\n")}</textarea>
            <div id="fp-list-remarks" style="display: none" class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="providers_check" value="1" id="providers-check" ${m.length?"checked":""}>
            <label id="providers-title" for="providers-check" class="form-label fw-bold"></label> &nbsp; &nbsp;
            <span id="providers-auto-title" class="text-info"></span>
            <textarea rows="7" name="providers" style="display: none" class="form-control" id="providers">${m.join("\n")}</textarea>
            <div id="providers-remarks"  style="display: none" class="form-text"></div>
          </div>
          <div class="mb-1 p-1">
            <input type="checkbox" class="form-check-input" name="configs_check" value="1" id="configs-check" ${_.length?"checked":""}>
            <label id="personal-configs-title" for="configs-check" class="form-label fw-bold"></label>
            <textarea rows="5" name="configs" style="display: none" class="form-control" id="configs">${_.join("\n")}</textarea>
            <div id="personal-configs-remarks" style="display: none" class="form-text"></div>
          </div>
          ${v=r?`
      <div class="mb-3 p-1">
        <button type="submit" name="reset_password" value="1" class="btn btn-danger">Remove Password / \u062D\u0630\u0641 \u06A9\u0644\u0645\u0647 \u0639\u0628\u0648\u0631</button>
      </div>
      `:`
      <div class="mb-1 p-1 pb-0 pt-3 mt-3 border-top border-primary border-4">
        <label for="configs" class="form-label fw-bold"> Security&nbsp;</label>
      </div>
      <div class="mb-3 p-3 border rounded">
        <label for="password" class="form-label fw-bold">
          Enter password, if you want to protect panel / \u062F\u0631 \u0635\u0648\u0631\u062A\u06CC \u06A9\u0647 \u0645\u06CC\u062E\u0648\u0627\u0647\u06CC\u062F \u0627\u0632 \u067E\u0646\u0644 \u0645\u062D\u0627\u0641\u0638\u062A \u06A9\u0646\u06CC\u062F\u060C \u06CC\u06A9 \u06A9\u0644\u0645\u0647\u200C\u06CC \u0639\u0628\u0648\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F:
        </label>
        <input type="password" name="password" class="form-control" id="password" minlength="6"/>
        <div class="form-text">
          Minimum 6 chars / \u062D\u062F\u0627\u0642\u0644 \u06F6 \u06A9\u0627\u0631\u0627\u06A9\u062A\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F.
        </div>
        <p></p>
        <label for="password-confirmation" class="form-label fw-bold">
          Confirm your password / \u06A9\u0644\u0645\u0647 \u0639\u0628\u0648\u0631 \u0631\u0627 \u0645\u062C\u062F\u062F\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F:
        </label>
        <input type="password" name="password_confirmation" class="form-control" id="password-confirmation" minlength="6"/>
      </div>
      `}
          <button type="submit" id="save-button" name="save" value="save" class="btn btn-primary"></button>
          <button type="submit" id="reset-button" name="reset" value="reset" class="btn btn-warning"></button>
        </form>
        <div class="p-1 border-top border-2 border-primary">
          <div class="text-nowrap fs-6">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" role="img" class="octicon">
              <g clip-path="url(#clip0_1668_3024)">
                <path d="M9.52217 6.77143L15.4785 0H14.0671L8.89516 5.87954L4.76437 0H0L6.24656 8.8909L0 15.9918H1.41155L6.87321 9.78279L11.2356 15.9918H16L9.52183 6.77143H9.52217ZM7.58887 8.96923L6.95596 8.0839L1.92015 1.03921H4.0882L8.15216 6.7245L8.78507 7.60983L14.0677 14.9998H11.8997L7.58887 8.96957V8.96923Z" fill="currentColor"></path>
              </g>
              <defs>
                <clipPath id="clip0_1668_3024">
                  <rect width="16" height="16" fill="white"></rect>
                </clipPath>
              </defs>
            </svg>
            <a class="link-dark link-offset-2" href="https://twitter.com/vahidfarid" target="_blank">@vahidfarid</a><br/>
            
            <svg height="16" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-mark-github v-align-middle color-fg-default">
              <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
            </svg>
            <a class="link-dark link-offset-2" href="https://github.com/vfarid" target="_blank">vfarid</a>            </p>
          </div>
        </div>
      </div>
    </body>
    </html>
    `;return new Response(E,{headers:{"Content-Type":"text/html"}})}catch(A){if(A instanceof TypeError){let k=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="utf8" />
          <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
        </head>
        <body id="body" style="--bs-body-font-size: .875rem">
          <div class="container border mt-3 p-0 border-primary border-2 rounded">
            <div id="lang-group" class="btn-group m-2" role="group" dir="ltr"></div>
            <div class="p-2 border-bottom border-primary border-2">
              <div class="text-nowrap fs-5 fw-bold text-dark">
                <span id="page-title"></span> &nbsp;&nbsp;<span class="text-nowrap fs-6 text-info"><span id="text-version"></span> ${version}</span>
              </div>
            </div>
            <div class="px-5 py-2 bg-light">
              <label id="sub-link-title" for="sub-link" class="form-label fw-bold"></label>
              <input id="sub-link" readonly value="${n.origin}/sub" class="p-1" style="width: calc(100% - 150px)">
              <button onclick="let tmp=document.getElementById('sub-link');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>
            </div>
            <div class="px-5 py-2 bg-light">
              <label id="clash-link-title" for="clash-link" class="form-label fw-bold"></label>
              <input id="clash-link" readonly value="${n.origin}/clash" class="p-1" style="width: calc(100% - 150px)">
              <button onclick="let tmp=document.getElementById('clash-link');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>
            </div>
            <div id="you-can-use-your-worker-message" class="mx-5 my-2 p-4 border bg-success text-white fw-bold text-center"></div>
            <div class="mx-5 my-2 p-1 border bg-warning">
              <div id="you-need-namespace-message"></div>
              <ol>
                <li>
                  <a id="open-kv-text" href="https://dash.cloudflare.com/?to=/:account/workers/kv/namespaces" target="_blank"></a>
                </li>
                <li>
                  <a id="open-variables-text" href="https://dash.cloudflare.com/?to=/:account/workers/services/view/${n.hostname.split(".")[0]}/production/settings/bindings" target="_blank"></a>
                </li>
              </ol>
            </div>
            <div class="p-1 border-top border-2 border-primary">
              <div class="text-nowrap fs-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" role="img" class="octicon">
                  <g clip-path="url(#clip0_1668_3024)">
                    <path d="M9.52217 6.77143L15.4785 0H14.0671L8.89516 5.87954L4.76437 0H0L6.24656 8.8909L0 15.9918H1.41155L6.87321 9.78279L11.2356 15.9918H16L9.52183 6.77143H9.52217ZM7.58887 8.96923L6.95596 8.0839L1.92015 1.03921H4.0882L8.15216 6.7245L8.78507 7.60983L14.0677 14.9998H11.8997L7.58887 8.96957V8.96923Z" fill="currentColor"></path>
                  </g>
                  <defs>
                    <clipPath id="clip0_1668_3024">
                      <rect width="16" height="16" fill="white"></rect>
                    </clipPath>
                  </defs>
                </svg>
                <a class="link-dark link-offset-2" href="https://twitter.com/vahidfarid" target="_blank">@vahidfarid</a><br/>
                
                <svg height="16" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-mark-github v-align-middle color-fg-default">
                  <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
                </svg>
                <a class="link-dark link-offset-2" href="https://github.com/vfarid" target="_blank">vfarid</a>            </p>
              </div>
            </div>
          </div>
        </body>
        <script>
        let language = localStorage.getItem("lang") || "fa"
        window.addEventListener("load", (event) => {
          initLang();
          setLang(language);
        });
    
        function initLang() {
          document.getElementById("lang-group").innerHTML = ""
          for (code in strings) {
            const el = document.createElement("button")
            el.classList = "btn btn-outline-primary btn-sm rounded-2"
            el.id = \`btn-\${code}\`
            el.type = "button"
            el.innerText = code.toUpperCase()
            el.setAttribute("data-lang", code);
            el.addEventListener("click", (e) => {
                setLang(e.srcElement.getAttribute("data-lang"))
            })
            document.getElementById("lang-group").appendChild(el)
    
            const el2 = document.createElement("span")
            el2.innerHTML = "&nbsp;"
            document.getElementById("lang-group").appendChild(el2)
          }
        }
      
        function setLang(code) {
          if (strings[code] === undefined) {
            code = "en"
          }
          
          document.getElementById('body').style.direction = languages[code]?.dir || "ltr"
          document.getElementById('lang-group').style.float = languages[code]?.end || "left"
          document.getElementById('btn-' + language).classList.remove('btn-primary')
          document.getElementById('btn-' + language).classList.add('btn-outline-primary')
          document.getElementById('btn-' + code).classList.remove('btn-outline-primary')
          document.getElementById('btn-' + code).classList.add('btn-primary')
          
          for (key in strings[code]) {
            document.getElementById(key).innerText = strings[code][key]
          }
      
          language = code
          localStorage.setItem('lang', code);
        }
    
        const languages = {
          en: {dir: "ltr", end: "right"},
          fa: {dir: "rtl", end: "left"},
        }
      
        const strings = {
          en: {
            "page-title": "V2ray Worker Control Panel",
            "text-version": "Version",
            "sub-link-title": "Your subscription link for v2ray clients (v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box...)",
            // "custom-link-title": "Your subscription link for custom configs",
            "clash-link-title": "Your subscription link for clash clients (Clash, ClashX, ClashMeta...)",
            "you-can-use-your-worker-message": "You can continue using your worker without control panel.",
            "you-need-namespace-message": "The 'settings' namespace is not defined! Please define a namespace named 'settings' in your worker 'KV Namespace Bindings' using bellow link, as described in the video and relad the page afterward.",  
            "open-kv-text": "Open KV",
            "open-variables-text": "Open Worker's Variables",
          },
          fa: {
            "page-title": "\u067E\u0646\u0644 \u06A9\u0646\u062A\u0631\u0644 \u0648\u0631\u06A9\u0631 v2ray",
            "text-version": "\u0646\u0633\u062E\u0647",
            "sub-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0644\u0627\u06CC\u0646\u062A\u200C\u0647\u0627\u06CC v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box \u0648...",
            // "custom-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0627\u0646\u0641\u06CC\u06AF\u200C\u0647\u0627\u06CC Custom",
            "clash-link-title": "\u0644\u06CC\u0646\u06A9 \u062B\u0628\u062A \u0646\u0627\u0645 \u0634\u0645\u0627 \u0628\u0631\u0627\u06CC \u06A9\u0644\u0627\u06CC\u0646\u062A\u200C\u0647\u0627\u06CC \u06A9\u0644\u0634 Clash, ClashX, ClashMeta \u0648...",
            "you-can-use-your-worker-message": "\u0634\u0645\u0627 \u0645\u06CC\u200C\u062A\u0648\u0627\u0646\u06CC\u062F \u0627\u0632 \u0648\u0631\u06A9\u0631 \u062E\u0648\u062F \u0628\u062F\u0648\u0646 \u067E\u0646\u0644 \u06A9\u0646\u062A\u0631\u0644 \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u0646\u0645\u0627\u06CC\u06CC\u062F.",
            "you-need-namespace-message": "\u0641\u0636\u0627\u06CC \u0646\u0627\u0645 settings \u062A\u0639\u0631\u06CC\u0641 \u0646\u0634\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0645\u0637\u0627\u0628\u0642 \u0648\u06CC\u062F\u06CC\u0648\u06CC \u0622\u0645\u0648\u0632\u0634\u06CC\u060C \u0627\u0632 \u0637\u0631\u06CC\u0642 \u0644\u06CC\u0646\u06A9\u200C\u0647\u0627\u06CC \u0632\u06CC\u0631 \u0627\u0628\u062A\u062F\u0627 \u062F\u0631 \u0628\u062E\u0634 KV \u06CC\u06A9 \u0641\u0636\u0627\u06CC \u0646\u0627\u0645 \u0628\u0647 \u0627\u0633\u0645 settings \u0627\u06CC\u062C\u0627\u062F \u06A9\u0646\u06CC\u062F \u0648 \u0633\u067E\u0633 \u0627\u0632\u0637\u0631\u06CC\u0642 \u0628\u062E\u0634 'KV Namespace Bindings' \u0622\u0646 \u0631\u0627 \u0628\u0627 \u0647\u0645\u0627\u0646 \u0646\u0627\u0645 settings \u0628\u0647 \u0648\u0631\u06A9\u0631 \u062E\u0648\u062F \u0645\u062A\u0635\u0644 \u06A9\u0646\u06CC\u062F \u0648 \u067E\u0633 \u0627\u0632 \u0630\u062E\u06CC\u0631\u0647\u060C \u0645\u062C\u062F\u062F\u0627 \u067E\u0646\u0644 \u0631\u0627 \u0628\u0627\u0632 \u06A9\u0646\u06CC\u062F.",
            "open-kv-text": "\u0628\u0627\u0632\u06A9\u0631\u062F\u0646 \u0628\u062E\u0634 KV",
            "open-variables-text": "\u0628\u0627\u0632\u06A9\u0631\u062F\u0646 \u0628\u062E\u0634 \u0645\u062A\u063A\u06CC\u0631\u0647\u0627\u06CC \u0648\u0631\u06A9\u0631",
          },
        }
        </script>
        </html>
      `;return new Response(k,{headers:{"Content-Type":"text/html"}})}throw A}}async function PostPanel(e,t){let n=new URL(e.url),r=await t.settings.get("Token");try{let o=await e.formData(),s=await t.settings.get("Password");if(s&&n.searchParams.get("token")!=r)return Response.redirect(`${n.origin}/login`,302);if(o.get("reset_password"))return await t.settings.delete("Password"),await t.settings.delete("Token"),Response.redirect(`${n.origin}?message=success`,302);if(o.get("save")){let a=o.get("password")?.toString()||"";if(a){if(a.length<6||a!==o.get("password_confirmation"))return Response.redirect(`${n.origin}?message=invalid-password`,302);s=await bcrypt.hash(a,10),r=GenerateToken(24),await t.settings.put("Password",s),await t.settings.put("Token",r)}let u=parseInt(o.get("max")?.toString()||"200");u<50&&(u=50),await t.settings.put("MaxConfigs",u.toString()),await t.settings.put("Protocols",o.getAll("protocols")?.join("\n").trim()),await t.settings.put("ALPNs",o.get("alpn_list_check")?.toString()&&o.get("alpn_list")?.toString().trim().split("\n").map(e=>e.trim()).join("\n")||""),await t.settings.put("FingerPrints",o.get("fp_list_check")?.toString()&&o.get("fp_list")?.toString().trim().split("\n").map(e=>e.trim()).join("\n")||""),await t.settings.put("Providers",o.get("providers_check")?.toString()&&o.get("providers")?.toString().trim().split("\n").map(e=>e.trim()).join("\n")||""),await t.settings.put("Countries",o.get("countries_check")?.toString()&&o.getAll("countries[]")?.join(",")||""),await t.settings.put("CleanDomainIPs",o.get("clean_ips_check")?.toString()&&o.get("clean_ips")?.toString().trim().split("\n").map(e=>e.trim()).join("\n")||""),await t.settings.put("Configs",o.get("configs_check")?.toString()&&o.get("configs")?.toString().trim().split("\n").map(e=>e.trim()).join("\n")||""),await t.settings.put("IncludeOriginalConfigs",o.get("original")?.toString()||"no"),await t.settings.put("IncludeMergedConfigs",o.get("merged")?.toString()||"no"),await t.settings.put("BlockPorn",o.get("block_porn")?.toString()||"no"),await t.settings.put("EnableFragments",o.get("enable_fragments")?.toString()||"no"),await t.settings.put("Version",version)}else await t.settings.delete("MaxConfigs"),await t.settings.delete("Protocols"),await t.settings.delete("ALPNs"),await t.settings.delete("FingerPrints"),await t.settings.delete("Providers"),await t.settings.delete("Countries"),await t.settings.delete("CleanDomainIPs"),await t.settings.delete("Configs"),await t.settings.delete("IncludeOriginalConfigs"),await t.settings.delete("IncludeMergedConfigs"),await t.settings.delete("UUID"),await t.settings.delete("Password"),await t.settings.delete("Token"),await t.settings.delete("BlockPorn"),await t.settings.delete("EnableFragments");return Response.redirect(`${n.origin}?message=success${r?"&token="+r:""}`,302)}catch($){return Response.redirect(`${n.origin}?message=error${r?"&token="+r:""}`,302)}}init_modules_watch_stub();var bcrypt2=__toESM(require_bcrypt());async function GetLogin(e,t){let n=new URL(e.url),r="",o=n.searchParams.get("message");"error"==o&&(r='<div class="p-3 bg-danger text-white fw-bold text-center">Invalid password / \\u06A9\\u0644\\u0645\\u0647 \\u0639\\u0628\\u0648\\u0631 \\u0645\\u0639\\u062A\\u0628\\u0631 \\u0646\\u0645\\u06CC\\u200C\\u0628\\u0627\\u0634\\u062F!</div>');let s=`
  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf8" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    </head>
    <body dir="ltr">
      <div class="container border p-0">
        <div class="p-3 bg-primary text-white">
          <div class="text-nowrap fs-4 fw-bold text-center">V2RAY Worker - Control Panel</div>
          <div class="text-nowrap fs-6 text-center">
            Version ${version}
          </div>
        </div>
        ${r}
        <form class="mt-5 p-3 row g-3" method="post">
          <div class="col-auto">
            Enter password / \u06A9\u0644\u0645\u0647\u200C\u06CC \u0639\u0628\u0648\u0631 \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F:
          </div>
          <div class="col-auto">
            <label for="inputPassword2" class="visually-hidden">Password</label>
            <input type="password" class="form-control" id="inputPassword2" placeholder="Password" name="password" minlength="6" required>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-primary mb-3">Confirm identity / \u062A\u0627\u06CC\u06CC\u062F \u0647\u0648\u06CC\u062A</button>
          </div>
        </form>
      </div>
    </body>
  </html>
  `;return new Response(s,{headers:{"Content-Type":"text/html"}})}async function PostLogin(e,t){let n=new URL(e.url),r=await e.formData(),o=r.get("password")||"",s=await t.settings.get("Password")||"";await Delay(1e3);let a=await bcrypt2.compare(o,s);if(a){let u=GenerateToken(24);return await t.settings.put("Token",u),Response.redirect(`${n.protocol}//${n.hostname}${"443"!=n.port?":"+n.port:""}/?token=${u}`,302)}return Response.redirect(`${n.protocol}//${n.hostname}${"443"!=n.port?":"+n.port:""}/login?message=error`,302)}function isNothing(e){return null==e}function isObject(e){return"object"==typeof e&&null!==e}function toArray(e){return Array.isArray(e)?e:isNothing(e)?[]:[e]}function extend(e,t){var n,r,o,s;if(t)for(n=0,r=(s=Object.keys(t)).length;n<r;n+=1)e[o=s[n]]=t[o];return e}function repeat(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r}function isNegativeZero(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e}init_modules_watch_stub(),init_modules_watch_stub();var isNothing_1=isNothing,isObject_1=isObject,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function formatError(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function YAMLException$1(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack||""}YAMLException$1.prototype=Object.create(Error.prototype),YAMLException$1.prototype.constructor=YAMLException$1,YAMLException$1.prototype.toString=function e(t){return this.name+": "+formatError(this,t)};var exception=YAMLException$1;function getLine(e,t,n,r,o){var s="",a="",u=Math.floor(o/2)-1;return r-t>u&&(t=r-u+(s=" ... ").length),n-r>u&&(n=r+u-(a=" ...").length),{str:s+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+s.length}}function padStart(e,t){return common.repeat(" ",t-e.length)+e}function makeSnippet(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],o=[],s=-1;a=n.exec(e.buffer);)o.push(a.index),r.push(a.index+a[0].length),e.position<=a.index&&s<0&&(s=r.length-2);s<0&&(s=r.length-1);var a,u,$,l="",c=Math.min(e.line+t.linesAfter,o.length).toString().length,_=t.maxLength-(t.indent+c+3);for(u=1;u<=t.linesBefore&&!(s-u<0);u++)$=getLine(e.buffer,r[s-u],o[s-u],e.position-(r[s]-r[s-u]),_),l=common.repeat(" ",t.indent)+padStart((e.line-u+1).toString(),c)+" | "+$.str+"\n"+l;for($=getLine(e.buffer,r[s],o[s],e.position,_),l+=common.repeat(" ",t.indent)+padStart((e.line+1).toString(),c)+" | "+$.str+"\n",l+=common.repeat("-",t.indent+c+3+$.pos)+"^\n",u=1;u<=t.linesAfter&&!(s+u>=o.length);u++)$=getLine(e.buffer,r[s+u],o[s+u],e.position-(r[s]-r[s+u]),_),l+=common.repeat(" ",t.indent)+padStart((e.line+u+1).toString(),c)+" | "+$.str+"\n";return l.replace(/\n$/,"")}var snippet=makeSnippet,TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(e){var t={};return null!==e&&Object.keys(e).forEach(function(n){e[n].forEach(function(e){t[String(e)]=n})}),t}function Type$1(e,t){if(Object.keys(t=t||{}).forEach(function(t){if(-1===TYPE_CONSTRUCTOR_OPTIONS.indexOf(t))throw new exception('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=compileStyleAliases(t.styleAliases||null),-1===YAML_NODE_KINDS.indexOf(this.kind))throw new exception('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var type=Type$1;function compileList(e,t){var n=[];return e[t].forEach(function(e){var t=n.length;n.forEach(function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)}),n[t]=e}),n}function compileMap(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}function Schema$1(e){return this.extend(e)}Schema$1.prototype.extend=function e(t){var n=[],r=[];if(t instanceof type)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(e){if(!(e instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(e){if(!(e instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var o=Object.create(Schema$1.prototype);return o.implicit=(this.implicit||[]).concat(n),o.explicit=(this.explicit||[]).concat(r),o.compiledImplicit=compileList(o,"implicit"),o.compiledExplicit=compileList(o,"explicit"),o.compiledTypeMap=compileMap(o.compiledImplicit,o.compiledExplicit),o};var schema=Schema$1,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)}function constructYamlNull(){return null}function isNull(e){return null===e}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function resolveYamlBoolean(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)}function constructYamlBoolean(e){return"true"===e||"True"===e||"TRUE"===e}function isBoolean(e){return"[object Boolean]"===Object.prototype.toString.call(e)}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function isOctCode(e){return 48<=e&&e<=55}function isDecCode(e){return 48<=e&&e<=57}function resolveYamlInteger(e){if(null===e)return!1;var t,n=e.length,r=0,o=!1;if(!n)return!1;if(("-"===(t=e[r])||"+"===t)&&(t=e[++r]),"0"===t){if(r+1===n)return!0;if("b"===(t=e[++r])){for(r++;r<n;r++)if("_"!==(t=e[r])){if("0"!==t&&"1"!==t)return!1;o=!0}return o&&"_"!==t}if("x"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!isHexCode(e.charCodeAt(r)))return!1;o=!0}return o&&"_"!==t}if("o"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!isOctCode(e.charCodeAt(r)))return!1;o=!0}return o&&"_"!==t}}if("_"===t)return!1;for(;r<n;r++)if("_"!==(t=e[r])){if(!isDecCode(e.charCodeAt(r)))return!1;o=!0}return!!o&&"_"!==t}function constructYamlInteger(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(t=n[0])||"+"===t)&&("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)}function isInteger(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!common.isNegativeZero(e)}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(e){return!!(null!==e&&YAML_FLOAT_PATTERN.test(e)&&"_"!==e[e.length-1])}function constructYamlFloat(e){var t,n;return(n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t)?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(e))return"-0.0";return n=e.toString(10),SCIENTIFIC_WITHOUT_DOT.test(n)?n.replace("e",".e"):n}function isFloat(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||common.isNegativeZero(e))}var float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=failsafe.extend({implicit:[_null,bool,int,float]}),core=json,YAML_DATE_REGEXP=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(e){return null!==e&&(null!==YAML_DATE_REGEXP.exec(e)||null!==YAML_TIMESTAMP_REGEXP.exec(e))}function constructYamlTimestamp(e){var t,n,r,o,s,a,u,$,l,c,_=0,p=null;if(null===(t=YAML_DATE_REGEXP.exec(e))&&(t=YAML_TIMESTAMP_REGEXP.exec(e)),null===t)throw Error("Date resolve error");if(n=+t[1],r=+t[2]-1,o=+t[3],!t[4])return new Date(Date.UTC(n,r,o));if(s=+t[4],a=+t[5],u=+t[6],t[7]){for(_=t[7].slice(0,3);_.length<3;)_+="0";_=+_}return t[9]&&(p=(60*($=+t[10])+(l=+(t[11]||0)))*6e4,"-"===t[9]&&(p=-p)),c=new Date(Date.UTC(n,r,o,s,a,u,_)),p&&c.setTime(c.getTime()-p),c}function representYamlTimestamp(e){return e.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(e){return"<<"===e||null===e}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function resolveYamlBinary(e){if(null===e)return!1;var t,n,r=0,o=e.length,s=BASE64_MAP;for(n=0;n<o;n++)if(!((t=s.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0}function constructYamlBinary(e){var t,n,r=e.replace(/[\r\n=]/g,""),o=r.length,s=BASE64_MAP,a=0,u=[];for(t=0;t<o;t++)t%4==0&&t&&(u.push(a>>16&255),u.push(a>>8&255),u.push(255&a)),a=a<<6|s.indexOf(r.charAt(t));return 0==(n=o%4*6)?(u.push(a>>16&255),u.push(a>>8&255),u.push(255&a)):18===n?(u.push(a>>10&255),u.push(a>>2&255)):12===n&&u.push(a>>4&255),new Uint8Array(u)}function representYamlBinary(e){var t,n,r="",o=0,s=e.length,a=BASE64_MAP;for(t=0;t<s;t++)t%3==0&&t&&(r+=a[o>>18&63],r+=a[o>>12&63],r+=a[o>>6&63],r+=a[63&o]),o=(o<<8)+e[t];return 0==(n=s%3)?(r+=a[o>>18&63],r+=a[o>>12&63],r+=a[o>>6&63],r+=a[63&o]):2===n?(r+=a[o>>10&63],r+=a[o>>4&63],r+=a[o<<2&63],r+=a[64]):1===n&&(r+=a[o>>2&63],r+=a[o<<4&63],r+=a[64],r+=a[64]),r}function isBinary(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString;function resolveYamlOmap(e){if(null===e)return!0;var t,n,r,o,s,a=[],u=e;for(t=0,n=u.length;t<n;t+=1){if(r=u[t],s=!1,"[object Object]"!==_toString$2.call(r))return!1;for(o in r)if(_hasOwnProperty$3.call(r,o)){if(s)return!1;s=!0}if(!s||-1!==a.indexOf(o))return!1;a.push(o)}return!0}function constructYamlOmap(e){return null!==e?e:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(e){if(null===e)return!0;var t,n,r,o,s,a=e;for(t=0,s=Array(a.length),n=a.length;t<n;t+=1){if(r=a[t],"[object Object]"!==_toString$1.call(r)||1!==(o=Object.keys(r)).length)return!1;s[t]=[o[0],r[o[0]]]}return!0}function constructYamlPairs(e){if(null===e)return[];var t,n,r,o,s,a=e;for(t=0,s=Array(a.length),n=a.length;t<n;t+=1)o=Object.keys(r=a[t]),s[t]=[o[0],r[o[0]]];return s}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$2=Object.prototype.hasOwnProperty;function resolveYamlSet(e){if(null===e)return!0;var t,n=e;for(t in n)if(_hasOwnProperty$2.call(n,t)&&null!==n[t])return!1;return!0}function constructYamlSet(e){return null!==e?e:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),_default=core.extend({implicit:[timestamp,merge],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(e){return Object.prototype.toString.call(e)}function is_EOL(e){return 10===e||13===e}function is_WHITE_SPACE(e){return 9===e||32===e}function is_WS_OR_EOL(e){return 9===e||32===e||10===e||13===e}function is_FLOW_INDICATOR(e){return 44===e||91===e||93===e||123===e||125===e}function fromHexCode(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function escapedHexLen(e){return 120===e?2:117===e?4:85===e?8:0}function fromDecimalCode(e){return 48<=e&&e<=57?e-48:-1}function simpleEscapeSequence(e){return 48===e?"\0":97===e?"\x07":98===e?"\b":116===e?"	":9===e?"	":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"\x85":95===e?"\xa0":76===e?"\u2028":80===e?"\u2029":""}function charFromCodepoint(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var simpleEscapeCheck=Array(256),simpleEscapeMap=Array(256);for(i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||_default,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=snippet(n),new exception(t,n)}function throwError(e,t){throw generateError(e,t)}function throwWarning(e,t){e.onWarning&&e.onWarning.call(null,generateError(e,t))}var directiveHandlers={YAML:function e(t,n,r){var o,s,a;null!==t.version&&throwError(t,"duplication of %YAML directive"),1!==r.length&&throwError(t,"YAML directive accepts exactly one argument"),null===(o=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&throwError(t,"ill-formed argument of the YAML directive"),s=parseInt(o[1],10),a=parseInt(o[2],10),1!==s&&throwError(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,1!==a&&2!==a&&throwWarning(t,"unsupported YAML version of the document")},TAG:function e(t,n,r){var o,s;2!==r.length&&throwError(t,"TAG directive accepts exactly two arguments"),o=r[0],s=r[1],PATTERN_TAG_HANDLE.test(o)||throwError(t,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(t.tagMap,o)&&throwError(t,'there is a previously declared suffix for "'+o+'" tag handle'),PATTERN_TAG_URI.test(s)||throwError(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch(a){throwError(t,"tag prefix is malformed: "+s)}t.tagMap[o]=s}};function captureSegment(e,t,n,r){var o,s,a,u;if(t<n){if(u=e.input.slice(t,n),r)for(o=0,s=u.length;o<s;o+=1)9===(a=u.charCodeAt(o))||32<=a&&a<=1114111||throwError(e,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(u)&&throwError(e,"the stream contains non-printable characters");e.result+=u}}function mergeMappings(e,t,n,r){var o,s,a,u;for(common.isObject(n)||throwError(e,"cannot merge mappings; the provided source object is unacceptable"),o=Object.keys(n),a=0,u=o.length;a<u;a+=1)s=o[a],_hasOwnProperty$1.call(t,s)||(t[s]=n[s],r[s]=!0)}function storeMappingPair(e,t,n,r,o,s,a,u,$){var l,c;if(Array.isArray(o))for(l=0,c=(o=Array.prototype.slice.call(o)).length;l<c;l+=1)Array.isArray(o[l])&&throwError(e,"nested arrays are not supported inside keys"),"object"==typeof o&&"[object Object]"===_class(o[l])&&(o[l]="[object Object]");if("object"==typeof o&&"[object Object]"===_class(o)&&(o="[object Object]"),o=String(o),null===t&&(t={}),"tag:yaml.org,2002:merge"===r){if(Array.isArray(s))for(l=0,c=s.length;l<c;l+=1)mergeMappings(e,t,s[l],n);else mergeMappings(e,t,s,n)}else!e.json&&!_hasOwnProperty$1.call(n,o)&&_hasOwnProperty$1.call(t,o)&&(e.line=a||e.line,e.lineStart=u||e.lineStart,e.position=$||e.position,throwError(e,"duplicated mapping key")),"__proto__"===o?Object.defineProperty(t,o,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[o]=s,delete n[o];return t}function readLineBreak(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):throwError(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function skipSeparationSpace(e,t,n){for(var r=0,o=e.input.charCodeAt(e.position);0!==o;){for(;is_WHITE_SPACE(o);)9===o&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),o=e.input.charCodeAt(++e.position);if(t&&35===o)do o=e.input.charCodeAt(++e.position);while(10!==o&&13!==o&&0!==o);if(is_EOL(o))for(readLineBreak(e),o=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position);else break}return -1!==n&&0!==r&&e.lineIndent<n&&throwWarning(e,"deficient indentation"),r}function testDocumentSeparator(e){var t,n=e.position;return!!((45===(t=e.input.charCodeAt(n))||46===t)&&t===e.input.charCodeAt(n+1)&&t===e.input.charCodeAt(n+2)&&(n+=3,0===(t=e.input.charCodeAt(n))||is_WS_OR_EOL(t)))}function writeFoldedLines(e,t){1===t?e.result+=" ":t>1&&(e.result+=common.repeat("\n",t-1))}function readPlainScalar(e,t,n){var r,o,s,a,u,$,l,c,_,p=e.kind,d=e.result;if(is_WS_OR_EOL(_=e.input.charCodeAt(e.position))||is_FLOW_INDICATOR(_)||35===_||38===_||42===_||33===_||124===_||62===_||39===_||34===_||37===_||64===_||96===_||(63===_||45===_)&&(is_WS_OR_EOL(o=e.input.charCodeAt(e.position+1))||n&&is_FLOW_INDICATOR(o)))return!1;for(e.kind="scalar",e.result="",s=a=e.position,u=!1;0!==_;){if(58===_){if(is_WS_OR_EOL(o=e.input.charCodeAt(e.position+1))||n&&is_FLOW_INDICATOR(o))break}else if(35===_){if(is_WS_OR_EOL(r=e.input.charCodeAt(e.position-1)))break}else if(e.position===e.lineStart&&testDocumentSeparator(e)||n&&is_FLOW_INDICATOR(_))break;else if(is_EOL(_)){if($=e.line,l=e.lineStart,c=e.lineIndent,skipSeparationSpace(e,!1,-1),e.lineIndent>=t){u=!0,_=e.input.charCodeAt(e.position);continue}e.position=a,e.line=$,e.lineStart=l,e.lineIndent=c;break}u&&(captureSegment(e,s,a,!1),writeFoldedLines(e,e.line-$),s=a=e.position,u=!1),is_WHITE_SPACE(_)||(a=e.position+1),_=e.input.charCodeAt(++e.position)}return captureSegment(e,s,a,!1),!!e.result||(e.kind=p,e.result=d,!1)}function readSingleQuotedScalar(e,t){var n,r,o;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=o=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(captureSegment(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,o=e.position}else is_EOL(n)?(captureSegment(e,r,o,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,t)),r=o=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a single quoted scalar"):(e.position++,o=e.position);throwError(e,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(e,t){var n,r,o,s,a,u;if(34!==(u=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(u=e.input.charCodeAt(e.position));){if(34===u)return captureSegment(e,n,e.position,!0),e.position++,!0;if(92===u){if(captureSegment(e,n,e.position,!0),is_EOL(u=e.input.charCodeAt(++e.position)))skipSeparationSpace(e,!1,t);else if(u<256&&simpleEscapeCheck[u])e.result+=simpleEscapeMap[u],e.position++;else if((a=escapedHexLen(u))>0){for(o=a,s=0;o>0;o--)(a=fromHexCode(u=e.input.charCodeAt(++e.position)))>=0?s=(s<<4)+a:throwError(e,"expected hexadecimal character");e.result+=charFromCodepoint(s),e.position++}else throwError(e,"unknown escape sequence");n=r=e.position}else is_EOL(u)?(captureSegment(e,n,r,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,t)),n=r=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}throwError(e,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(e,t){var n,r,o,s,a,u,$,l,c,_,p,d,h,g=!0,m=e.tag,y=e.anchor,b=Object.create(null);if(91===(h=e.input.charCodeAt(e.position)))u=93,c=!1,s=[];else{if(123!==h)return!1;u=125,c=!0,s={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),h=e.input.charCodeAt(++e.position);0!==h;){if(skipSeparationSpace(e,!0,t),(h=e.input.charCodeAt(e.position))===u)return e.position++,e.tag=m,e.anchor=y,e.kind=c?"mapping":"sequence",e.result=s,!0;g?44===h&&throwError(e,"expected the node content, but found ','"):throwError(e,"missed comma between flow collection entries"),p=_=d=null,$=l=!1,63===h&&is_WS_OR_EOL(a=e.input.charCodeAt(e.position+1))&&($=l=!0,e.position++,skipSeparationSpace(e,!0,t)),n=e.line,r=e.lineStart,o=e.position,composeNode(e,t,CONTEXT_FLOW_IN,!1,!0),p=e.tag,_=e.result,skipSeparationSpace(e,!0,t),h=e.input.charCodeAt(e.position),(l||e.line===n)&&58===h&&($=!0,h=e.input.charCodeAt(++e.position),skipSeparationSpace(e,!0,t),composeNode(e,t,CONTEXT_FLOW_IN,!1,!0),d=e.result),c?storeMappingPair(e,s,b,p,_,d,n,r,o):$?s.push(storeMappingPair(e,null,b,p,_,d,n,r,o)):s.push(_),skipSeparationSpace(e,!0,t),44===(h=e.input.charCodeAt(e.position))?(g=!0,h=e.input.charCodeAt(++e.position)):g=!1}throwError(e,"unexpected end of the stream within a flow collection")}function readBlockScalar(e,t){var n,r,o,s,a=CHOMPING_CLIP,u=!1,$=!1,l=t,c=0,_=!1;if(124===(s=e.input.charCodeAt(e.position)))r=!1;else{if(62!==s)return!1;r=!0}for(e.kind="scalar",e.result="";0!==s;)if(43===(s=e.input.charCodeAt(++e.position))||45===s)CHOMPING_CLIP===a?a=43===s?CHOMPING_KEEP:CHOMPING_STRIP:throwError(e,"repeat of a chomping mode identifier");else if((o=fromDecimalCode(s))>=0)0===o?throwError(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):$?throwError(e,"repeat of an indentation width identifier"):(l=t+o-1,$=!0);else break;if(is_WHITE_SPACE(s)){do s=e.input.charCodeAt(++e.position);while(is_WHITE_SPACE(s));if(35===s)do s=e.input.charCodeAt(++e.position);while(!is_EOL(s)&&0!==s)}for(;0!==s;){for(readLineBreak(e),e.lineIndent=0,s=e.input.charCodeAt(e.position);(!$||e.lineIndent<l)&&32===s;)e.lineIndent++,s=e.input.charCodeAt(++e.position);if(!$&&e.lineIndent>l&&(l=e.lineIndent),is_EOL(s)){c++;continue}if(e.lineIndent<l){a===CHOMPING_KEEP?e.result+=common.repeat("\n",u?1+c:c):a===CHOMPING_CLIP&&u&&(e.result+="\n");break}for(r?is_WHITE_SPACE(s)?(_=!0,e.result+=common.repeat("\n",u?1+c:c)):_?(_=!1,e.result+=common.repeat("\n",c+1)):0===c?u&&(e.result+=" "):e.result+=common.repeat("\n",c):e.result+=common.repeat("\n",u?1+c:c),u=!0,$=!0,c=0,n=e.position;!is_EOL(s)&&0!==s;)s=e.input.charCodeAt(++e.position);captureSegment(e,n,e.position,!1)}return!0}function readBlockSequence(e,t){var n,r,o,s=e.tag,a=e.anchor,u=[],$=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=u),o=e.input.charCodeAt(e.position);0!==o&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),45===o&&is_WS_OR_EOL(r=e.input.charCodeAt(e.position+1)));){if($=!0,e.position++,skipSeparationSpace(e,!0,-1)&&e.lineIndent<=t){u.push(null),o=e.input.charCodeAt(e.position);continue}if(n=e.line,composeNode(e,t,CONTEXT_BLOCK_IN,!1,!0),u.push(e.result),skipSeparationSpace(e,!0,-1),o=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==o)throwError(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return!!$&&(e.tag=s,e.anchor=a,e.kind="sequence",e.result=u,!0)}function readBlockMapping(e,t,n){var r,o,s,a,u,$,l,c=e.tag,_=e.anchor,p={},d=Object.create(null),h=null,g=null,m=null,y=!1,b=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),l=e.input.charCodeAt(e.position);0!==l;){if(y||-1===e.firstTabInLine||(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(63===l||58===l)&&is_WS_OR_EOL(r))63===l?(y&&(storeMappingPair(e,p,d,h,g,null,a,u,$),h=g=m=null),b=!0,y=!0,o=!0):y?(y=!1,o=!0):throwError(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,l=r;else{if(a=e.line,u=e.lineStart,$=e.position,!composeNode(e,n,CONTEXT_FLOW_OUT,!1,!0))break;if(e.line===s){for(l=e.input.charCodeAt(e.position);is_WHITE_SPACE(l);)l=e.input.charCodeAt(++e.position);if(58===l)is_WS_OR_EOL(l=e.input.charCodeAt(++e.position))||throwError(e,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(storeMappingPair(e,p,d,h,g,null,a,u,$),h=g=m=null),b=!0,y=!1,o=!1,h=e.tag,g=e.result;else{if(!b)return e.tag=c,e.anchor=_,!0;throwError(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!b)return e.tag=c,e.anchor=_,!0;throwError(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}if((e.line===s||e.lineIndent>t)&&(y&&(a=e.line,u=e.lineStart,$=e.position),composeNode(e,t,CONTEXT_BLOCK_OUT,!0,o)&&(y?g=e.result:m=e.result),y||(storeMappingPair(e,p,d,h,g,m,a,u,$),h=g=m=null),skipSeparationSpace(e,!0,-1),l=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&0!==l)throwError(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return y&&storeMappingPair(e,p,d,h,g,null,a,u,$),b&&(e.tag=c,e.anchor=_,e.kind="mapping",e.result=p),b}function readTagProperty(e){var t,n,r,o,s=!1,a=!1;if(33!==(o=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&throwError(e,"duplication of a tag property"),60===(o=e.input.charCodeAt(++e.position))?(s=!0,o=e.input.charCodeAt(++e.position)):33===o?(a=!0,n="!!",o=e.input.charCodeAt(++e.position)):n="!",t=e.position,s){do o=e.input.charCodeAt(++e.position);while(0!==o&&62!==o);e.position<e.length?(r=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):throwError(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!is_WS_OR_EOL(o);)33===o&&(a?throwError(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),PATTERN_TAG_HANDLE.test(n)||throwError(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),PATTERN_FLOW_INDICATORS.test(r)&&throwError(e,"tag suffix cannot contain flow indicator characters")}r&&!PATTERN_TAG_URI.test(r)&&throwError(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(u){throwError(e,"tag name is malformed: "+r)}return s?e.tag=r:_hasOwnProperty$1.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:throwError(e,'undeclared tag handle "'+n+'"'),!0}function readAnchorProperty(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&throwError(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!is_WS_OR_EOL(n)&&!is_FLOW_INDICATOR(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&throwError(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function readAlias(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!is_WS_OR_EOL(r)&&!is_FLOW_INDICATOR(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&throwError(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),_hasOwnProperty$1.call(e.anchorMap,n)||throwError(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],skipSeparationSpace(e,!0,-1),!0}function composeNode(e,t,n,r,o){var s,a,u,$,l,c,_,p,d,h=1,g=!1,m=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=a=u=CONTEXT_BLOCK_OUT===n||CONTEXT_BLOCK_IN===n,r&&skipSeparationSpace(e,!0,-1)&&(g=!0,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)),1===h)for(;readTagProperty(e)||readAnchorProperty(e);)skipSeparationSpace(e,!0,-1)?(g=!0,u=s,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)):u=!1;if(u&&(u=g||o),(1===h||CONTEXT_BLOCK_OUT===n)&&(p=CONTEXT_FLOW_IN===n||CONTEXT_FLOW_OUT===n?t:t+1,d=e.position-e.lineStart,1===h?u&&(readBlockSequence(e,d)||readBlockMapping(e,d,p))||readFlowCollection(e,p)?m=!0:(a&&readBlockScalar(e,p)||readSingleQuotedScalar(e,p)||readDoubleQuotedScalar(e,p)?m=!0:readAlias(e)?(m=!0,(null!==e.tag||null!==e.anchor)&&throwError(e,"alias node should not have any properties")):readPlainScalar(e,p,CONTEXT_FLOW_IN===n)&&(m=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===h&&(m=u&&readBlockSequence(e,d))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&throwError(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),$=0,l=e.implicitTypes.length;$<l;$+=1)if((_=e.implicitTypes[$]).resolve(e.result)){e.result=_.construct(e.result),e.tag=_.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(_hasOwnProperty$1.call(e.typeMap[e.kind||"fallback"],e.tag))_=e.typeMap[e.kind||"fallback"][e.tag];else for($=0,_=null,l=(c=e.typeMap.multi[e.kind||"fallback"]).length;$<l;$+=1)if(e.tag.slice(0,c[$].tag.length)===c[$].tag){_=c[$];break}_||throwError(e,"unknown tag !<"+e.tag+">"),null!==e.result&&_.kind!==e.kind&&throwError(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+_.kind+'", not "'+e.kind+'"'),_.resolve(e.result,e.tag)?(e.result=_.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):throwError(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||m}function readDocument(e){var t,n,r,o,s=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(o=e.input.charCodeAt(e.position))&&(skipSeparationSpace(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0)&&37===o);){for(a=!0,o=e.input.charCodeAt(++e.position),t=e.position;0!==o&&!is_WS_OR_EOL(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(t,e.position),r=[],n.length<1&&throwError(e,"directive name must not be less than one character in length");0!==o;){for(;is_WHITE_SPACE(o);)o=e.input.charCodeAt(++e.position);if(35===o){do o=e.input.charCodeAt(++e.position);while(0!==o&&!is_EOL(o));break}if(is_EOL(o))break;for(t=e.position;0!==o&&!is_WS_OR_EOL(o);)o=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==o&&readLineBreak(e),_hasOwnProperty$1.call(directiveHandlers,n)?directiveHandlers[n](e,n,r):throwWarning(e,'unknown document directive "'+n+'"')}if(skipSeparationSpace(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,skipSeparationSpace(e,!0,-1)):a&&throwError(e,"directives end mark is expected"),composeNode(e,e.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(e,!0,-1),e.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(e.input.slice(s,e.position))&&throwWarning(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&testDocumentSeparator(e)){46===e.input.charCodeAt(e.position)&&(e.position+=3,skipSeparationSpace(e,!0,-1));return}e.position<e.length-1&&throwError(e,"end of the stream or a document separator is expected")}function loadDocuments(e,t){e=String(e),t=t||{},0!==e.length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new State$1(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,throwError(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)readDocument(n);return n.documents}function loadAll$1(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=loadDocuments(e,n);if("function"!=typeof t)return r;for(var o=0,s=r.length;o<s;o+=1)t(r[o])}function load$1(e,t){var n=loadDocuments(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new exception("expected a single document in the stream, but found more")}}var loadAll_1=loadAll$1,load_1=load$1,loader={loadAll:loadAll_1,load:load_1},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_BOM=65279,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={};ESCAPE_SEQUENCES[0]="\\0",ESCAPE_SEQUENCES[7]="\\a",ESCAPE_SEQUENCES[8]="\\b",ESCAPE_SEQUENCES[9]="\\t",ESCAPE_SEQUENCES[10]="\\n",ESCAPE_SEQUENCES[11]="\\v",ESCAPE_SEQUENCES[12]="\\f",ESCAPE_SEQUENCES[13]="\\r",ESCAPE_SEQUENCES[27]="\\e",ESCAPE_SEQUENCES[34]='\\"',ESCAPE_SEQUENCES[92]="\\\\",ESCAPE_SEQUENCES[133]="\\N",ESCAPE_SEQUENCES[160]="\\_",ESCAPE_SEQUENCES[8232]="\\L",ESCAPE_SEQUENCES[8233]="\\P";var DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(e,t){var n,r,o,s,a,u,$;if(null===t)return{};for(o=0,n={},s=(r=Object.keys(t)).length;o<s;o+=1)u=String(t[a=r[o]]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),($=e.compiledTypeMap.fallback[a])&&_hasOwnProperty.call($.styleAliases,u)&&(u=$.styleAliases[u]),n[a]=u;return n}function encodeHex(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new exception("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+common.repeat("0",r-t.length)+t}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State(e){this.schema=e.schema||_default,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=common.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=compileStyleMap(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(e,t){for(var n,r=common.repeat(" ",t),o=0,s=-1,a="",u=e.length;o<u;)-1===(s=e.indexOf("\n",o))?(n=e.slice(o),o=u):(n=e.slice(o,s+1),o=s+1),n.length&&"\n"!==n&&(a+=r),a+=n;return a}function generateNextLine(e,t){return"\n"+common.repeat(" ",e.indent*t)}function testImplicitResolving(e,t){var n,r,o;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if((o=e.implicitTypes[n]).resolve(t))return!0;return!1}function isWhitespace(e){return e===CHAR_SPACE||e===CHAR_TAB}function isPrintable(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==CHAR_BOM||65536<=e&&e<=1114111}function isNsCharOrWhitespace(e){return isPrintable(e)&&e!==CHAR_BOM&&e!==CHAR_CARRIAGE_RETURN&&e!==CHAR_LINE_FEED}function isPlainSafe(e,t,n){var r=isNsCharOrWhitespace(e),o=r&&!isWhitespace(e);return(n?r:r&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET)&&e!==CHAR_SHARP&&!(t===CHAR_COLON&&!o)||isNsCharOrWhitespace(t)&&!isWhitespace(t)&&e===CHAR_SHARP||t===CHAR_COLON&&o}function isPlainSafeFirst(e){return isPrintable(e)&&e!==CHAR_BOM&&!isWhitespace(e)&&e!==CHAR_MINUS&&e!==CHAR_QUESTION&&e!==CHAR_COLON&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET&&e!==CHAR_SHARP&&e!==CHAR_AMPERSAND&&e!==CHAR_ASTERISK&&e!==CHAR_EXCLAMATION&&e!==CHAR_VERTICAL_LINE&&e!==CHAR_EQUALS&&e!==CHAR_GREATER_THAN&&e!==CHAR_SINGLE_QUOTE&&e!==CHAR_DOUBLE_QUOTE&&e!==CHAR_PERCENT&&e!==CHAR_COMMERCIAL_AT&&e!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(e){return!isWhitespace(e)&&e!==CHAR_COLON}function codePointAt(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?(r-55296)*1024+n-56320+65536:r}function needIndentIndicator(e){return/^\n* /.test(e)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(e,t,n,r,o,s,a,u){var $,l=0,c=null,_=!1,p=!1,d=-1!==r,h=-1,g=isPlainSafeFirst(codePointAt(e,0))&&isPlainSafeLast(codePointAt(e,e.length-1));if(t||a)for($=0;$<e.length;l>=65536?$+=2:$++){if(l=codePointAt(e,$),!isPrintable(l))return STYLE_DOUBLE;g=g&&isPlainSafe(l,c,u),c=l}else{for($=0;$<e.length;l>=65536?$+=2:$++){if((l=codePointAt(e,$))===CHAR_LINE_FEED)_=!0,d&&(p=p||$-h-1>r&&" "!==e[h+1],h=$);else if(!isPrintable(l))return STYLE_DOUBLE;g=g&&isPlainSafe(l,c,u),c=l}p=p||d&&$-h-1>r&&" "!==e[h+1]}return _||p?n>9&&needIndentIndicator(e)?STYLE_DOUBLE:a?s===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:p?STYLE_FOLDED:STYLE_LITERAL:!g||a||o(e)?s===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:STYLE_PLAIN}function writeScalar(e,t,n,r,o){e.dump=function(){if(0===t.length)return e.quotingType===QUOTING_TYPE_DOUBLE?'""':"''";if(!e.noCompatMode&&(-1!==DEPRECATED_BOOLEANS_SYNTAX.indexOf(t)||DEPRECATED_BASE60_SYNTAX.test(t)))return e.quotingType===QUOTING_TYPE_DOUBLE?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),u=r||e.flowLevel>-1&&n>=e.flowLevel;switch(chooseScalarStyle(t,u,e.indent,a,function t(n){return testImplicitResolving(e,n)},e.quotingType,e.forceQuotes&&!r,o)){case STYLE_PLAIN:return t;case STYLE_SINGLE:return"'"+t.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(t,e.indent)+dropEndingNewline(indentString(t,s));case STYLE_FOLDED:return">"+blockHeader(t,e.indent)+dropEndingNewline(indentString(foldString(t,a),s));case STYLE_DOUBLE:return'"'+escapeString(t)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(e,t){var n,r=needIndentIndicator(e)?String(t):"",o="\n"===e[e.length-1];return r+(o&&("\n"===e[e.length-2]||"\n"===e)?"+":o?"":"-")+"\n"}function dropEndingNewline(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function foldString(e,t){for(var n,r,o,s=/(\n+)([^\n]*)/g,a=(o=-1!==(o=e.indexOf("\n"))?o:e.length,s.lastIndex=o,foldLine(e.slice(0,o),t)),u="\n"===e[0]||" "===e[0];r=s.exec(e);){var $=r[1],l=r[2];n=" "===l[0],a+=$+(u||n||""===l?"":"\n")+foldLine(l,t),u=n}return a}function foldLine(e,t){if(""===e||" "===e[0])return e;for(var n,r,o=/ [^ ]/g,s=0,a=0,u=0,$="";n=o.exec(e);)(u=n.index)-s>t&&(r=a>s?a:u,$+="\n"+e.slice(s,r),s=r+1),a=u;return $+="\n",e.length-s>t&&a>s?$+=e.slice(s,a)+"\n"+e.slice(a+1):$+=e.slice(s),$.slice(1)}function escapeString(e){for(var t,n="",r=0,o=0;o<e.length;r>=65536?o+=2:o++)!(t=ESCAPE_SEQUENCES[r=codePointAt(e,o)])&&isPrintable(r)?(n+=e[o],r>=65536&&(n+=e[o+1])):n+=t||encodeHex(r);return n}function writeFlowSequence(e,t,n){var r,o,s,a="",u=e.tag;for(r=0,o=n.length;r<o;r+=1)s=n[r],e.replacer&&(s=e.replacer.call(n,String(r),s)),(writeNode(e,t,s,!1,!1)||void 0===s&&writeNode(e,t,null,!1,!1))&&(""!==a&&(a+=","+(e.condenseFlow?"":" ")),a+=e.dump);e.tag=u,e.dump="["+a+"]"}function writeBlockSequence(e,t,n,r){var o,s,a,u="",$=e.tag;for(o=0,s=n.length;o<s;o+=1)a=n[o],e.replacer&&(a=e.replacer.call(n,String(o),a)),(writeNode(e,t+1,a,!0,!0,!1,!0)||void 0===a&&writeNode(e,t+1,null,!0,!0,!1,!0))&&(r&&""===u||(u+=generateNextLine(e,t)),e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?u+="-":u+="- ",u+=e.dump);e.tag=$,e.dump=u||"[]"}function writeFlowMapping(e,t,n){var r,o,s,a,u,$="",l=e.tag,c=Object.keys(n);for(r=0,o=c.length;r<o;r+=1){if(u="",""!==$&&(u+=", "),e.condenseFlow&&(u+='"'),a=n[s=c[r]],e.replacer&&(a=e.replacer.call(n,s,a)),writeNode(e,t,s,!1,!1))e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),writeNode(e,t,a,!1,!1)&&(u+=e.dump,$+=u)}e.tag=l,e.dump="{"+$+"}"}function writeBlockMapping(e,t,n,r){var o,s,a,u,$,l,c="",_=e.tag,p=Object.keys(n);if(!0===e.sortKeys)p.sort();else if("function"==typeof e.sortKeys)p.sort(e.sortKeys);else if(e.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(o=0,s=p.length;o<s;o+=1){if(l="",r&&""===c||(l+=generateNextLine(e,t)),u=n[a=p[o]],e.replacer&&(u=e.replacer.call(n,a,u)),writeNode(e,t+1,a,!0,!0,!0))($=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?l+="?":l+="? "),l+=e.dump,$&&(l+=generateNextLine(e,t)),writeNode(e,t+1,u,!0,$)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?l+=":":l+=": ",l+=e.dump,c+=l)}e.tag=_,e.dump=c||"{}"}function detectType(e,t,n){var r,o,s,a,u,$;for(s=0,a=(o=n?e.explicitTypes:e.implicitTypes).length;s<a;s+=1)if(((u=o[s]).instanceOf||u.predicate)&&(!u.instanceOf||"object"==typeof t&&t instanceof u.instanceOf)&&(!u.predicate||u.predicate(t))){if(n?u.multi&&u.representName?e.tag=u.representName(t):e.tag=u.tag:e.tag="?",u.represent){if($=e.styleMap[u.tag]||u.defaultStyle,"[object Function]"===_toString.call(u.represent))r=u.represent(t,$);else if(_hasOwnProperty.call(u.represent,$))r=u.represent[$](t,$);else throw new exception("!<"+u.tag+'> tag resolver accepts not "'+$+'" style');e.dump=r}return!0}return!1}function writeNode(e,t,n,r,o,s,a){e.tag=null,e.dump=n,detectType(e,n,!1)||detectType(e,n,!0);var u=_toString.call(e.dump),$=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var l,c,_,p="[object Object]"===u||"[object Array]"===u;if(p&&(_=-1!==(c=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||_||2!==e.indent&&t>0)&&(o=!1),_&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(p&&_&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),"[object Object]"===u)r&&0!==Object.keys(e.dump).length?(writeBlockMapping(e,t,e.dump,o),_&&(e.dump="&ref_"+c+e.dump)):(writeFlowMapping(e,t,e.dump),_&&(e.dump="&ref_"+c+" "+e.dump));else if("[object Array]"===u)r&&0!==e.dump.length?(e.noArrayIndent&&!a&&t>0?writeBlockSequence(e,t-1,e.dump,o):writeBlockSequence(e,t,e.dump,o),_&&(e.dump="&ref_"+c+e.dump)):(writeFlowSequence(e,t,e.dump),_&&(e.dump="&ref_"+c+" "+e.dump));else if("[object String]"===u)"?"!==e.tag&&writeScalar(e,e.dump,t,s,$);else{if("[object Undefined]"===u||e.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+u)}null!==e.tag&&"?"!==e.tag&&(l=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),l="!"===e.tag[0]?"!"+l:"tag:yaml.org,2002:"===l.slice(0,18)?"!!"+l.slice(18):"!<"+l+">",e.dump=l+" "+e.dump)}return!0}function getDuplicateReferences(e,t){var n,r,o=[],s=[];for(inspectNode(e,o,s),n=0,r=s.length;n<r;n+=1)t.duplicates.push(o[s[n]]);t.usedDuplicates=Array(r)}function inspectNode(e,t,n){var r,o,s;if(null!==e&&"object"==typeof e){if(-1!==(o=t.indexOf(e)))-1===n.indexOf(o)&&n.push(o);else if(t.push(e),Array.isArray(e))for(o=0,s=e.length;o<s;o+=1)inspectNode(e[o],t,n);else for(o=0,s=(r=Object.keys(e)).length;o<s;o+=1)inspectNode(e[r[o]],t,n)}}function dump$1(e,t){t=t||{};var n=new State(t);n.noRefs||getDuplicateReferences(e,n);var r=e;return(n.replacer&&(r=n.replacer.call({"":r},"",r)),writeNode(n,0,r,!0,!0))?n.dump+"\n":""}var dump_1=dump$1,dumper={dump:dump_1};function renamed(e,t){return function(){throw Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var Type=type,Schema=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SCHEMA=_default,load=loader.load,loadAll=loader.loadAll,dump=dumper.dump,YAMLException=exception,types={binary,float,map,null:_null,pairs,set,timestamp,bool,int,merge,omap,seq,str},safeLoad=renamed("safeLoad","load"),safeLoadAll=renamed("safeLoadAll","loadAll"),safeDump=renamed("safeDump","dump"),jsYaml={Type,Schema,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SCHEMA,load,loadAll,dump,YAMLException,types,safeLoad,safeLoadAll,safeDump},js_yaml_default=jsYaml,import_buffer2=__toESM(require_buffer());init_modules_watch_stub();var import_buffer=__toESM(require_buffer());function MixConfig(e,t,n,r){let o=MuddleDomain(t.hostname);try{let s={...e};if(["ws","h2","http"].includes(s.network)){if(!cfPorts.includes(s.port))throw Error("Port is not matched!")}else throw Error("Network is not supported!");let a=s.sni||s.host||s.address;if(IsIp(a))throw Error("Invalid SNI!");if(a.toLocaleLowerCase().endsWith(".workers.dev")||a.toLocaleLowerCase().endsWith(".pages.dev"))throw Error("Config is running on Cloudflare, Skipped!");s.remarks=s.remarks+"-worker";let u=s.path;return s.host=o,s.sni=o,s.address=n,s.path=`/${a}:${s.port}/${u.replace(/^\//g,"")}`,s.merged=!0,s}catch($){return null}}function EncodeConfig(e){try{if("vmess"==e.configType){let t={type:e.type,ps:e.remarks,add:e.address,port:e.port,id:e.uuid,aid:e.alterId||0,tls:e.tls,sni:e.sni,net:e.network,path:e.path,host:e.host,alpn:e.alpn,fp:e.fp};return`vmess://${import_buffer.Buffer.from(JSON.stringify(t),"utf-8").toString("base64")}`}if("vless"==e.configType)return`vless://${e.uuid}@${e.address}:${e.port}?encryption=${encodeURIComponent(e.encryption||"none")}&type=${e.network}${e.path?"&path="+encodeURIComponent(e.path):""}${e.host?"&host="+encodeURIComponent(e.host):""}${e.security?"&security="+encodeURIComponent(e.security):""}${e.flow?"&flow="+encodeURIComponent(e.flow):""}${e.pbk?"&pbk="+encodeURIComponent(e.pbk):""}${e.sid?"&sid="+encodeURIComponent(e.sid):""}${e.spx?"&spx="+encodeURIComponent(e.spx):""}${e.seed?"&seed="+encodeURIComponent(e.seed):""}${e.quicSecurity?"&quicSecurity="+encodeURIComponent(e.quicSecurity):""}${e.key?"&key="+encodeURIComponent(e.key):""}${e.mode?"&mode="+encodeURIComponent(e.mode):""}${e.authority?"&authority="+encodeURIComponent(e.authority):""}${e.headerType?"&headerType="+encodeURIComponent(e.headerType):""}${e.alpn?"&alpn="+encodeURIComponent(e.alpn):""}${e.fp?"&fp="+encodeURIComponent(e.fp):""}${e.fragment?"&fragment="+encodeURIComponent(e.fragment):""}&sni=${encodeURIComponent(e.sni||e.host||e.address)}#${encodeURIComponent(e.remarks)}`;if("trojan"==e.configType)return`${e.configType}://${e.password||e.uuid}@${e.address}:${e.port}?type=${e.network}${e.cipher?"&cipher="+encodeURIComponent(e.cipher):""}${e.path?"&path="+e.path:""}${e.host?"&host="+e.host:""}${e.alpn?"&alpn="+encodeURIComponent(e.alpn):""}${e.fp?"&fp="+encodeURIComponent(e.fp):""}${e.tls?"&tls=1":""}&sni=${encodeURIComponent(e.sni||e.host||e.address)}#${encodeURIComponent(e.remarks)}`}catch(n){}return""}function DecodeConfig(e){let t=null;if(e.startsWith("vmess://"))try{t=JSON.parse(import_buffer.Buffer.from(e.substring(8),"base64").toString("utf-8"));let n=t?.type||"";t={configType:"vmess",remarks:t?.ps,address:t.add,port:parseInt(t.port),uuid:t.id,alterId:t?.aid||0,security:t?.scy||"auto",network:t.net,type:n==t.net?"":n,host:t?.host,path:t?.path||"",tls:t?.tls||"",sni:t?.sni||t?.host}}catch(r){}else if(e.startsWith("vless://"))try{let o=new URL(e);t={configType:"vless",remarks:decodeURIComponent(o.hash.substring(1)),address:o.hostname,port:parseInt(o.port||("tls"==o.searchParams.get("tls")?"443":"80")),uuid:o.username,security:o.searchParams.get("security")||"",encryption:o.searchParams.get("encryption")||"none",type:o.searchParams.get("type")||"tcp",serviceName:o.searchParams.get("serviceName")||"",host:o.searchParams.get("host")||"",path:o.searchParams.get("path")||"",tls:"tls"==o.searchParams.get("security")?"tls":"",sni:o.searchParams.get("sni")||"",flow:o.searchParams.get("flow")||"",pbk:o.searchParams.get("pbk")||"",sid:o.searchParams.get("sid")||"",spx:o.searchParams.get("spx")||"",headerType:o.searchParams.get("headerType")||"",seed:o.searchParams.get("seed")||"",quicSecurity:o.searchParams.get("quicSecurity")||"",key:o.searchParams.get("key")||"",mode:o.searchParams.get("mode")||"",authority:o.searchParams.get("authority")||""}}catch(s){}return t}function ValidateConfig(e){try{if(["vmess","vless"].includes(e.configType)&&IsValidUUID(e.uuid)&&e.remarks||["trojan"].includes(e.configType)&&(e.uuid||e.password)&&e.remarks)return!!(e.address||e.sni)}catch(t){}return!1}async function GetConfigList(e,t){let n=200,r=[],o=[],s=[],a=[],u=!0,$=!0,l=[],c=[],_=!0,p=!1;try{n=parseInt(await t.settings.get("MaxConfigs")||"200");let d=await t.settings.get("Version")||"2.0";d==version&&(r=await t.settings.get("Protocols").then(e=>e?e.split("\n"):[]));let h=await t.settings.get("BlockPorn")=="yes",g=(await t.settings.get("Countries")||"").trim().length>0;h?(r=["built-in-vless"],n=20):g&&(r=["built-in-vless","built-in-trojan"],n=40),o=(await t.settings.get("Providers"))?.split("\n").filter(e=>e.trim().length>0)||[],s=(await t.settings.get("ALPNs"))?.split("\n").filter(e=>e.trim().length>0)||[],a=(await t.settings.get("FingerPrints"))?.split("\n").filter(e=>e.trim().length>0)||[],u="yes"==(await t.settings.get("IncludeOriginalConfigs")||"yes"),$="yes"==(await t.settings.get("IncludeMergedConfigs")||"yes")&&(r.includes("vmess")||r.includes("vless")),l=(await t.settings.get("CleanDomainIPs"))?.split("\n").filter(e=>e.trim().length>0)||[],_=await t.settings.get("MaxConfigs")===null,c=(await t.settings.get("Configs"))?.split("\n").filter(e=>e.trim().length>0)||[],p=await t.settings.get("EnableFragments")=="yes"}catch{}r=r.length?r:defaultProtocols,s=s.length?s:defaultALPNList,a=a.length?a:defaultPFList,l=l.length?l:[MuddleDomain(e.hostname)],r.includes("built-in-vless")&&(n-=20),r.includes("built-in-trojan")&&(n-=20),_&&(u=!0,$=!0),o.length||(o=await fetch(providersUri).then(e=>e.text()).then(e=>e.trim().split("\n").filter(e=>e.trim().length>0))),u&&$&&(n=Math.floor(n/2));let m=[],y=[],b=[],C=[],w=Math.floor(n/Object.keys(o).length);for(let v of o)try{var E=await fetch(v).then(e=>e.text());try{let A=js_yaml_default.load(E);if(!(C=A.proxies).length)throw"no-yaml";C=C.filter(e=>r.includes(e.type)).filter(ValidateConfig)}catch(k){IsBase64(E)&&(E=import_buffer2.Buffer.from(E,"base64").toString("utf-8")),(C=E.split("\n").filter(e=>e.match(RegExp(`^(${r.join("|")})://`,"i")))).length&&(C=C.map(DecodeConfig).filter(ValidateConfig))}$&&y.push({url:v,count:w,configs:C.filter(e=>["vmess","vless"].includes(e.configType)),mergedConfigs:null}),u&&m.push({url:v,count:w,configs:C})}catch(S){}l.length||(l=[MuddleDomain(e.hostname)]);let T=l[Math.floor(Math.random()*l.length)];for(let L in y){let I=y[L];y[L].mergedConfigs=I.configs.map(t=>MixConfig(t,e,T,I.name)).filter(e=>e?.merged&&e?.remarks)}let O=0;for(let P=0;P<5;P++)for(let N of y)N.count>N.mergedConfigs.length?(O=O+N.count-N.mergedConfigs.length,N.count=N.mergedConfigs.length):N.count<N.mergedConfigs.length&&O>0&&(N.count=N.count+Math.ceil(O/3),O-=Math.ceil(O/3));for(let B of y)b=b.concat(GetMultipleRandomElements(B.mergedConfigs,B.count));if(u){let R=0;for(let F=0;F<5;F++)for(let U of m)U.count>U.configs.length?(R=R+U.count-U.configs.length,U.count=U.configs.length):U.count<U.configs.length&&R>0&&(U.count=U.count+Math.ceil(R/3),R-=Math.ceil(R/3));for(let H of m)b=b.concat(GetMultipleRandomElements(H.configs,H.count))}c.length&&(b=b.concat(c.map(DecodeConfig))),b=RemoveDuplicateConfigs(b.filter(ValidateConfig));let D=[],M=[],Y=1;return r.includes("built-in-vless")&&(D=await GetVlessConfigList(e.hostname,l,Y,20,t),Y+=20),r.includes("built-in-trojan")&&(M=await GetTrojanConfigList(e.hostname,l,Y,20,t),Y+=20),b=(b=D.concat(M).concat(AddNumberToConfigs(b,Y))).map(e=>(e.fp=a[Math.floor(Math.random()*a.length)],e.alpn=s[Math.floor(Math.random()*s.length)],p&&"tls"==e.tls&&(e.fragment=`tlshello,${fragmentsLengthList[Math.floor(Math.random()*fragmentsLengthList.length)]},${fragmentsIntervalList[Math.floor(Math.random()*fragmentsIntervalList.length)]}`),e)),console.log(b),b}function ToYamlSubscription(e){let t=defaultClashConfig;t.proxies=e.map(e=>(({merged:e,...t})=>t)(e));let n=e.reduce((e,t)=>(e[t?.merged?"Worker":"Original"]||(e[t?.merged?"Worker":"Original"]=[]),e[t?.merged?"Worker":"Original"].push(t),e),{}),r=[];for(let o in n)r[o]=n[o];let s=[{name:"All",type:"select",proxies:["All - UrlTest","All - Fallback","All - LoadBalance(ch)","All - LoadBalance(rr)"].concat(Object.keys(r))},{name:"All - UrlTest",type:"url-test",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - Fallback",type:"fallback",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - LoadBalance(ch)",type:"load-balance",strategy:"consistent-hashing",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - LoadBalance(rr)",type:"load-balance",strategy:"round-robin",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)}];for(let a in r)s.push({name:a,type:"url-test",url:"http://clients3.google.com/generate_204",interval:600,proxies:r[a]});return t["proxy-groups"]=s,js_yaml_default.dump(t)}init_modules_watch_stub(),init_modules_watch_stub();var import_buffer3=__toESM(require_buffer());function ToRawSubscription(e){return e.map(EncodeConfig).join("\n")}function ToBase64Subscription(e){return import_buffer3.Buffer.from(e.map(EncodeConfig).join("\n"),"utf-8").toString("base64")}var worker_default={async fetch(e,t){let n=new URL(e.url),r=n.pathname.replace(/^\/|\/$/g,""),o=r.toLowerCase();if(["sub","clash","raw"].includes(o)){let s=await GetConfigList(n,t);return new Response("clash"==o?ToYamlSubscription(s):"raw"==o?ToRawSubscription(s):ToBase64Subscription(s))}if("vless-ws"==o)return VlessOverWSHandler(e,n.hostname,t);if("trojan-ws"==o)return TrojanOverWSHandler(e,n.hostname,t);if("login"==o){if("GET"===e.method)return GetLogin(e,t);if("POST"===e.method)return PostLogin(e,t)}else{if(r)return fetch(new Request(new URL("https://"+r),e));if("GET"===e.method)return GetPanel(e,t);if("POST"===e.method)return PostPanel(e,t)}return new Response("Invalid request!")}};export{worker_default as default}; /*! Bundled license information:

bcryptjs/dist/bcrypt.js:
  (**
   * @license bcrypt.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/bcrypt.js for details
   *)

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/ 
